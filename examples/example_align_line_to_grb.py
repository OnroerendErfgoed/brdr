from shapely import from_wkt

from brdr.aligner import Aligner
from brdr.be.grb.enums import GRBType
from brdr.be.grb.loader import GRBActualLoader
from brdr.enums import AlignerResultType
from brdr.loader import DictLoader

if __name__ == "__main__":
    aligner = Aligner()
    wkt = "MULTILINESTRING ((174135.22254434687783942 179531.39341345359571278, 174121.64978590866667219 179537.66386910632718354, 174118.0780073722708039 179538.69571623904630542, 174121.25292162684490904 179549.09356042271247134, 174114.98246597408433445 179551.23662754453835078, 174116.56992310137138702 179556.95147320273099467, 174110.85507744317874312 179559.41203175002010539))"
    wkt = "MULTILINESTRING ((174024.1298775521281641 179420.42107488788315095, 174042.22504128722357564 179413.1830093938333448, 174044.36356063772109337 179418.28255553735652938, 174049.29860529277357273 179418.94056149138486944, 174050.28561422377242707 179422.72409572688047774, 174054.39815143629675731 179421.90158828438143246, 174057.52367971779312938 179420.75007786488276906, 174054.56265292479656637 179408.08346325031016022, 174047.16008594224695116 179398.54237691726302728, 174036.960993655200582 179404.29992901478544809, 174032.84845644267625175 179400.51639477928983979, 174029.88742964965058491 179397.88437096326379105))"
    thematic_dict = {"theme_id_1": from_wkt(wkt)}

    loader = DictLoader(thematic_dict)
    aligner.load_thematic_data(loader)
    loader = GRBActualLoader(grb_type=GRBType.ADP, partition=1000, aligner=aligner)
    aligner.load_reference_data(loader)

    aligner_result = aligner.process(relevant_distances=[3])
    print(aligner_result.results["theme_id_1"][3]["result"])
    aligner_result = aligner.predict()
    aligner_result.save_results(
        path="output", result_type=AlignerResultType.PREDICTIONS, aligner=aligner
    )
