import unittest

from shapely import from_wkt
from shapely.geometry import Point
from shapely.geometry import Polygon

from brdr.geometry_utils import _grid_bounds, get_shape_index, geom_from_wkt
from brdr.geometry_utils import buffer_neg
from brdr.geometry_utils import buffer_neg_pos
from brdr.geometry_utils import buffer_pos
from brdr.geometry_utils import get_partitions
from brdr.geometry_utils import safe_difference
from brdr.geometry_utils import safe_intersection
from brdr.geometry_utils import safe_symmetric_difference
from brdr.geometry_utils import safe_union


class TestShapeIndex(unittest.TestCase):
    def test_shape_index_circle(self):
        point = Point(0, 0)
        result = buffer_pos(point, 1.0)
        assert get_shape_index(result.area, result.length) > 0.99

    def test_shape_index_0(self):
        assert get_shape_index(0, 0) == -1

    def test_shape_index(self):
        polygon = geom_from_wkt("POLYGON ((0 0, 0 9, 5 10, 10 0, 0 0))")
        shape_index = get_shape_index(polygon.area, polygon.length)
        assert shape_index > 0
        assert shape_index < 1


class TestBuffering(unittest.TestCase):
    def test_buffer_neg_pos_point(self):
        """Tests buffer_neg_pos with a point geometry."""
        point = Point(0, 0)
        result = buffer_neg_pos(point, 1.0)
        self.assertEqual(result, Polygon())

    def test_buffer_neg_pos_polygon(self):
        """Tests buffer_neg_pos with a polygon geometry."""
        polygon = Polygon([(0, 0), (1, 0), (1, 1), (0, 1)])
        result = buffer_neg_pos(polygon, 0.5)
        self.assertTrue(result.is_valid)

    def test_buffer_neg(self):
        """Tests buffer_neg with a point geometry."""
        point = Point(0, 0)
        result = buffer_neg(point, 1.0)
        self.assertEqual(result, Polygon())

    def test_buffer_pos(self):
        """Tests buffer_pos with a point geometry."""
        polygon = Polygon(((-1, -1), (-1, 1), (1, 1), (1, -1)))
        result = buffer_pos(polygon, 1.0)
        self.assertEqual(
            result, Polygon(((-2, -2), (-2, 2), (2, 2), (2, -2), (-2, -2)))
        )


class TestSafeOperations(unittest.TestCase):
    def test_safe_union(self):
        """Tests safe_union with two points."""
        polygon_a = Polygon(((0, 0), (1, 0), (1, 1), (0, 1), (0, 0)))
        polygon_b = Polygon(((1, 0), (2, 0), (2, 1), (1, 1), (1, 0)))
        result = safe_union(polygon_a, polygon_b)
        print(result)
        self.assertEqual(result.area, 2)

    def test_safe_union_geos_exception(self):
        """Tests safe_union with a geos exception."""

        polygon_a = from_wkt(
            "MULTIPOLYGON(((172767.25694 174472.63279888, "
            "172766.30994001 174470.77679888, "
            "172765.64794001 174469.48679888, "
            "172766.51694001 174469.12679888, "
            "172765.12794 174466.03679889, "
            "172764.34694001 174466.34679888, "
            "172762.84694001 174463.15679888, "
            "172764.28394001 174462.46479889, "
            "172765.32594 174461.96179888, "
            "172761.13894 174453.29579888, "
            "172760.09694001 174451.01679889, "
            "172759.79494001 174450.12279889, "
            "172760.93594001 174449.76179888, "
            "172761.82594 174450.27579889, "
            "172762.67394001 174449.91179889, "
            "172765.15694 174448.84679888, "
            "172764.19994001 174445.99879888, "
            "172764.60994 174445.80279889, "
            "172764.33894001 174444.31479888, "
            "172763.51694001 174441.74179888, "
            "172763.21994 174440.02779889, "
            "172761.17694 174440.68879888, "
            "172759.74794001 174436.70479888, "
            "172759.02694001 174436.93979888, "
            "172756.96694 174437.61179889, "
            "172755.11894001 174438.21379888, "
            "172754.95694001 174437.62679889, "
            "172754.60694 174436.35679889, "
            "172756.19994001 174435.93579889, "
            "172758.35594 174435.36579889, "
            "172760.84694001 174434.70679888, "
            "172760.58894001 174433.53579888, "
            "172760.14694 174431.53679889, "
            "172759.53294 174429.60779888, "
            "172759.38494 174428.15179888, "
            "172759.12694001 174427.54679888, "
            "172758.76694001 174426.28679889, "
            "172758.12194001 174424.02879888, "
            "172758.32294 174423.95879888, "
            "172758.05194 174421.82179889, "
            "172756.64394001 174422.12379888, "
            "172755.98194 174422.32379889, "
            "172755.12694001 174419.48579888, "
            "172753.83594001 174419.79579889, "
            "172752.49394001 174414.58679888, "
            "172751.20794001 174414.83379888, "
            "172750.65294001 174412.80779888, "
            "172748.95294001 174413.24779889, "
            "172748.47294 174411.39879889, "
            "172753.23294001 174410.11879888, "
            "172752.77094 174408.42079889, "
            "172752.20594 174406.34079888, "
            "172751.57694 174404.02979888, "
            "172750.94994001 174401.72379889, "
            "172750.44494 174399.86779889, "
            "172749.65394 174396.95879888, "
            "172749.08794 174394.87879889, "
            "172750.24394001 174394.48479888, "
            "172751.79494001 174393.68579889, "
            "172753.32194001 174392.89979888, "
            "172754.02694001 174394.06179888, "
            "172759.86194001 174390.84279888, "
            "172760.84694001 174392.75779888, "
            "172762.75294 174391.80779888, "
            "172764.67794001 174390.84979888, "
            "172767.03494001 174389.67579888, "
            "172769.10394001 174388.64579888, "
            "172770.82694 174387.78779888, "
            "172772.41294001 174387.00179889, "
            "172771.70694001 174385.58179888, "
            "172770.47494001 174383.10379888, "
            "172769.86494001 174381.87779888, "
            "172769.31094001 174380.77179889, "
            "172768.51694001 174379.18579889, "
            "172767.43494001 174377.02279888, "
            "172766.27794001 174374.71279889, "
            "172765.78994 174373.61879888, "
            "172765.24294 174372.39279888, "
            "172764.56294 174370.86879888, "
            "172763.48394 174368.72379889, "
            "172762.58994001 174366.94779889, "
            "172761.36994 174364.52279888, "
            "172760.27094 174362.33879888, "
            "172759.15994001 174360.12979888, "
            "172757.85194 174357.53079889, "
            "172752.91594 174345.84979888, "
            "172752.44494 174344.50079888, "
            "172751.68294 174342.55779888, "
            "172750.88594 174340.52579889, "
            "172749.87694001 174337.94779888, "
            "172748.82694 174335.20279888, "
            "172747.72094 174332.38879888, "
            "172746.51294001 174329.31579889, "
            "172745.36494001 174326.39779888, "
            "172743.82194001 174322.47179888, "
            "172742.68394 174319.57579888, "
            "172739.86294 174320.46079888, "
            "172737.67194 174320.96779888, "
            "172736.12194001 174321.39879889, "
            "172733.90294001 174322.01479889, "
            "172731.21594 174322.76179888, "
            "172729.70094 174323.15779889, "
            "172729.10494001 174323.34879888, "
            "172727.50294 174323.86079888, "
            "172724.60494001 174324.78679888, "
            "172719.82894001 174326.31279889, "
            "172720.17794001 174327.77779889, "
            "172720.41094 174328.75779888, "
            "172720.82494001 174330.49979889, "
            "172721.08494 174331.56079889, "
            "172721.42594 174332.98579888, "
            "172721.70594 174334.18179888, "
            "172722.03394001 174335.51479889, "
            "172722.60994 174337.84979888, "
            "172723.15794 174340.07079888, "
            "172719.07994 174341.35879889, "
            "172719.00094001 174340.49779889, "
            "172718.62994001 174340.60179888, "
            "172717.50294 174340.91679888, "
            "172714.97094 174341.62679888, "
            "172714.17294 174341.84979888, "
            "172712.47094 174342.32679888, "
            "172710.41394001 174342.90279889, "
            "172708.33894001 174343.48379889, "
            "172705.43894001 174344.29679888, "
            "172702.72094 174345.05779888, "
            "172703.36294 174347.25779888, "
            "172703.90994001 174349.13479888, "
            "172702.14294 174349.59779889, "
            "172700.29694 174350.08079888, "
            "172697.39194001 174350.83979889, "
            "172695.26994001 174351.39479888, "
            "172694.94394 174349.74379888, "
            "172692.57994 174350.34579889, "
            "172689.68394 174351.08279889, "
            "172686.95894 174351.77579889, "
            "172684.89594 174352.30079888, "
            "172683.30094 174352.70679888, "
            "172681.18294 174353.24579888, "
            "172679.33194001 174353.71579888, "
            "172677.40094 174354.20779889, "
            "172676.77394001 174351.89279888, "
            "172676.06194 174349.26679889, "
            "172675.74094001 174348.08279889, "
            "172675.25994 174346.30779888, "
            "172674.46694 174343.38379889, "
            "172673.58194001 174340.11779889, "
            "172672.77094 174337.12779888, "
            "172670.94994001 174337.60879888, "
            "172669.08994001 174338.09979888, "
            "172668.25594001 174338.31979889, "
            "172663.54094 174339.43779888, "
            "172663.95094 174340.99179888, "
            "172664.37094 174342.58279889, "
            "172664.94494 174344.75679888, "
            "172665.47294 174346.75879889, "
            "172666.08594001 174349.08279889, "
            "172666.77094 174351.67579889, "
            "172667.44094 174354.21779888, "
            "172665.21794001 174354.76179888, "
            "172663.37894 174355.21179888, "
            "172661.58094 174355.65179889, "
            "172659.15894001 174356.24379888, "
            "172656.24094001 174356.95779889, "
            "172655.82894001 174354.98779888, "
            "172655.30694001 174352.49479889, "
            "172654.75394 174349.85379888, "
            "172653.44094 174347.26779888, "
            "172650.79094 174346.37779888, "
            "172649.39294 174346.74579888, "
            "172648.16994001 174347.06779889, "
            "172643.14494001 174348.38979889, "
            "172640.56794001 174349.06779889, "
            "172638.06294 174349.72679888, "
            "172635.80894 174350.31979889, "
            "172634.01694001 174350.79179888, "
            "172631.56094001 174351.43779889, "
            "172631.68094001 174351.69779888, "
            "172630.46894001 174352.05179889, "
            "172629.28094001 174352.39979888, "
            "172627.68094001 174352.86779889, "
            "172628.10094001 174354.11979889, "
            "172628.68794 174355.86679889, "
            "172629.43094001 174358.08279889, "
            "172630.24694001 174360.51479889, "
            "172630.85694 174362.33379888, "
            "172631.76094 174365.02779889, "
            "172632.43094001 174364.86779889, "
            "172632.93494001 174366.67479889, "
            "172630.87694001 174367.28679889, "
            "172629.35094001 174367.69579888, "
            "172627.54894001 174368.17979889, "
            "172625.44094 174368.74479889, "
            "172623.82194001 174369.17879888, "
            "172621.82194001 174369.71579888, "
            "172620.13194 174370.16879888, "
            "172618.52894 174370.59879889, "
            "172616.85694 174371.04679888, "
            "172613.67694 174372.43679888, "
            "172612.27094 174372.87179888, "
            "172610.70894 174373.35479889, "
            "172608.85694 174373.92679889, "
            "172608.25794001 174371.89079888, "
            "172607.82694 174370.42679889, "
            "172607.50694 174370.51679889, "
            "172607.38694001 174370.06679888, "
            "172607.01194001 174368.70179889, "
            "172605.61394 174369.12679889, "
            "172604.29194001 174364.49979888, "
            "172605.79494001 174364.27579889, "
            "172604.95794001 174361.23079889, "
            "172604.15694 174358.31679888, "
            "172601.38294001 174359.08279889, "
            "172599.73694001 174359.53679889, "
            "172599.03094001 174356.96479888, "
            "172598.45694001 174354.87679889, "
            "172598.31094001 174353.65579888, "
            "172597.92494001 174352.22579889, "
            "172597.51694001 174350.71679889, "
            "172593.94294001 174351.68579889, "
            "172594.45994 174353.59579889, "
            "172594.89194001 174355.18879888, "
            "172594.43694 174355.28679889, "
            "172595.10394001 174357.58879888, "
            "172595.61694 174359.35679889, "
            "172596.36994 174361.95579889, "
            "172596.92694 174363.87679888, "
            "172594.25694 174364.45679888, "
            "172594.21694 174364.31679888, "
            "172593.00494001 174364.65379888, "
            "172592.00394 174364.93279888, "
            "172590.26894 174365.41579889, "
            "172588.36994 174365.94479889, "
            "172586.29894001 174366.52079888, "
            "172585.71094001 174364.28879889, "
            "172585.01994001 174361.66879889, "
            "172584.37794 174359.23179889, "
            "172583.45694001 174355.73579888, "
            "172582.56194 174352.34079888, "
            "172581.81194 174349.49579888, "
            "172578.83494 174350.40579889, "
            "172579.40794 174352.63579888, "
            "172579.78994 174354.11679888, "
            "172580.28794001 174356.05279889, "
            "172580.77094 174357.92779888, "
            "172581.47694 174360.66679888, "
            "172581.97094 174362.58679888, "
            "172582.24294 174363.61779889, "
            "172582.54194001 174364.74379888, "
            "172582.91294001 174366.13879888, "
            "172583.24094001 174367.37179888, "
            "172583.56894 174368.60379888, "
            "172583.98394 174370.16379889, "
            "172584.46094001 174371.95479888, "
            "172584.86494001 174373.47379888, "
            "172585.18994 174374.69679889, "
            "172581.69994001 174375.73579888, "
            "172581.45894 174374.65479888, "
            "172581.93994 174374.65479888, "
            "172582.48094 174373.39279888, "
            "172580.61794 174366.54279888, "
            "172576.54694 174367.44579888, "
            "172576.96094001 174368.82979888, "
            "172577.49594 174370.61579889, "
            "172578.20294001 174372.70579888, "
            "172578.57394 174374.21879889, "
            "172578.69794 174374.72879888, "
            "172578.94194001 174375.71979888, "
            "172579.21594 174376.83779888, "
            "172579.48694001 174377.94179888, "
            "172579.78194 174379.14479889, "
            "172580.08194001 174380.37079888, "
            "172580.58694 174382.33779888, "
            "172578.45494 174382.82579888, "
            "172576.95294001 174376.09679888, "
            "172576.23194 174376.15679888, "
            "172575.20994 174372.55179889, "
            "172573.66494 174372.83079889, "
            "172574.33394 174375.25079888, "
            "172574.79994001 174376.93479888, "
            "172574.46694 174377.10679889, "
            "172573.55494 174377.38579888, "
            "172571.95794001 174377.87279889, "
            "172569.12694001 174378.73679888, "
            "172570.29694 174382.59679888, "
            "172569.06894 174382.95779889, "
            "172567.62494 174383.37779888, "
            "172566.17594 174383.79879889, "
            "172564.97094 174384.14879888, "
            "172563.53494001 174384.56479888, "
            "172562.23594001 174384.94279889, "
            "172561.03494001 174385.29079889, "
            "172559.35194 174385.66979888, "
            "172558.39794001 174385.88479888, "
            "172556.63694001 174386.28179888, "
            "172554.56194 174386.74879888, "
            "172554.93394 174388.02679888, "
            "172555.33194001 174389.39779888, "
            "172555.78394001 174390.95079888, "
            "172556.25094001 174392.55979888, "
            "172556.78094001 174394.38279888, "
            "172557.38394001 174396.45779889, "
            "172555.12994001 174410.66979888, "
            "172554.04194001 174412.21079889, "
            "172554.18094001 174413.74279889, "
            "172554.35894 174415.69279889, "
            "172554.59094 174418.23979888, "
            "172554.80294001 174420.57479888, "
            "172555.02794001 174423.04279888, "
            "172555.93294 174422.97279889, "
            "172557.54494001 174422.84879889, "
            "172560.00094001 174422.89679889, "
            "172562.04294 174422.83779889, "
            "172563.99094001 174422.77979888, "
            "172565.29094 174422.74079889, "
            "172567.21594 174422.68179889, "
            "172569.10194 174422.62379888, "
            "172568.98294001 174421.27879888, "
            "172568.88094001 174420.13579889, "
            "172568.73194 174418.45579889, "
            "172568.45294001 174415.31879888, "
            "172570.64394 174415.21279889, "
            "172570.64394001 174420.55979889, "
            "172572.08594001 174420.43979888, "
            "172572.08594001 174421.46179888, "
            "172572.89894001 174421.52179889, "
            "172572.93594001 174418.69679889, "
            "172572.92794001 174415.53279888, "
            "172575.20994 174415.51279889, "
            "172575.27294001 174421.23079888, "
            "172577.66994001 174421.37079888, "
            "172577.71794001 174420.68179889, "
            "172577.72494001 174418.93679889, "
            "172577.73594001 174415.93279888, "
            "172580.01694001 174415.87379888, "
            "172579.83694 174420.49979889, "
            "172581.27894 174420.49979889, "
            "172581.16094 174421.60179888, "
            "172582.17694 174421.66979888, "
            "172582.13594 174422.43279888, "
            "172582.06294 174423.81779889, "
            "172581.85494001 174425.10579888, "
            "172581.54394 174425.96979888, "
            "172582.27094 174425.90879888, "
            "172583.34994001 174425.81679888, "
            "172584.44594001 174425.72479888, "
            "172585.57394 174425.43879889, "
            "172587.27294001 174425.00679888, "
            "172589.82794001 174424.35879889, "
            "172589.40294001 174423.53179888, "
            "172589.03494001 174422.06079888, "
            "172588.59694001 174420.30879889, "
            "172588.35594 174419.34679888, "
            "172587.97694 174417.82879889, "
            "172587.78294 174417.05679889, "
            "172587.61594001 174415.77979888, "
            "172587.36494001 174414.35979888, "
            "172587.75394 174413.42079888, "
            "172587.86994 174411.44879889, "
            "172592.26794 174410.32279888, "
            "172592.57794001 174412.11779889, "
            "172593.54694 174411.85679889, "
            "172593.88294001 174413.17479889, "
            "172596.71694 174412.45279888, "
            "172597.50594001 174415.42779888, "
            "172593.94094 174416.36279888, "
            "172594.31794001 174417.67579888, "
            "172595.57994 174417.37579888, "
            "172595.88594 174418.96979888, "
            "172599.56994 174418.29279888, "
            "172600.39494001 174421.68079888, "
            "172599.12494 174422.00279888, "
            "172597.83994001 174422.32779888, "
            "172595.25594001 174422.98279888, "
            "172595.67794001 174424.90679888, "
            "172598.81094001 174424.21879889, "
            "172599.32294 174426.26379888, "
            "172599.83994001 174428.32779888, "
            "172600.28294 174430.09379889, "
            "172599.53294 174430.30379888, "
            "172598.94794 174431.12079888, "
            "172598.50794001 174431.73679888, "
            "172598.17194 174432.53079888, "
            "172597.70394001 174433.63779889, "
            "172598.26694001 174435.35479889, "
            "172601.68394 174434.46579888, "
            "172602.63794001 174437.85679889, "
            "172603.52094 174441.33179888, "
            "172604.18794 174443.95879889, "
            "172607.05394 174443.20479888, "
            "172608.01694001 174447.05779888, "
            "172602.61494001 174448.18279888, "
            "172603.57694 174451.96779888, "
            "172591.37294001 174454.98979888, "
            "172593.09694001 174460.86279888, "
            "172596.00694 174460.12279889, "
            "172599.45294001 174459.24579888, "
            "172605.06394001 174457.81879888, "
            "172608.39694 174456.97079889, "
            "172613.56094001 174455.65679888, "
            "172614.32594 174458.77479888, "
            "172609.11894001 174459.86879888, "
            "172606.47194001 174460.59979888, "
            "172604.45794001 174461.15679888, "
            "172605.34094 174464.77179889, "
            "172607.57394 174464.20979889, "
            "172609.99094001 174463.60579889, "
            "172613.07994 174462.83479889, "
            "172613.61894001 174464.88379889, "
            "172614.04994001 174466.51979889, "
            "172614.37794 174467.76679889, "
            "172612.53894001 174468.36579889, "
            "172611.16394001 174468.81479888, "
            "172608.52994 174469.67379888, "
            "172609.11194001 174471.76679889, "
            "172609.56494 174473.39879889, "
            "172612.91294001 174485.56179888, "
            "172614.59894 174485.11079888, "
            "172617.38894 174484.36379889, "
            "172622.33194001 174483.04179888, "
            "172625.99594 174482.06079889, "
            "172629.84294001 174481.03179888, "
            "172641.95194 174477.65279889, "
            "172643.75494001 174477.16979888, "
            "172645.38894 174476.73279888, "
            "172647.53094001 174476.15979889, "
            "172649.87894 174475.53179888, "
            "172652.14894001 174474.92479889, "
            "172655.08794 174474.13879889, "
            "172656.82294 174473.67479889, "
            "172659.20494 174473.03779889, "
            "172661.12994001 174472.52279888, "
            "172663.13094001 174471.98779888, "
            "172666.07294 174471.20079888, "
            "172669.09894 174470.39179889, "
            "172670.32794001 174470.07579888, "
            "172672.24694001 174469.58179889, "
            "172673.91894 174469.15179888, "
            "172674.58694 174468.84879889, "
            "172675.52994 174468.59879889, "
            "172677.88094001 174467.97779889, "
            "172680.51794 174467.28079889, "
            "172683.39194001 174466.52079888, "
            "172686.88994 174465.59579889, "
            "172690.08694 174464.75079888, "
            "172693.60394001 174463.82179889, "
            "172694.71594 174465.90079889, "
            "172695.81494 174467.95779889, "
            "172696.76694001 174469.73679889, "
            "172698.74294 174473.43379889, "
            "172700.00894001 174475.80279888, "
            "172701.21194 174478.05279888, "
            "172702.29394 174480.07679889, "
            "172712.67294 174477.65879888, "
            "172714.31294 174477.23479888, "
            "172715.92294 174476.81879889, "
            "172718.15094 174476.24279889, "
            "172719.85594 174475.80279888, "
            "172719.07394 174472.68079888, "
            "172722.78994 174471.85879889, "
            "172723.62094 174471.64979888, "
            "172726.34994001 174470.96079888, "
            "172727.68494001 174470.62379888, "
            "172728.34494 174470.45779889, "
            "172728.94594001 174470.31079889, "
            "172729.36494001 174470.20779889, "
            "172733.29694 174468.74879888, "
            "172732.51594001 174463.94179888, "
            "172736.18094001 174462.86079888, "
            "172736.12094 174460.75779888, "
            "172739.38594 174460.04779889, "
            "172751.74194 174457.62979889, "
            "172752.52594 174459.31079889, "
            "172753.47194001 174461.34079888, "
            "172754.32394 174463.17079889, "
            "172755.22994001 174465.11479888, "
            "172756.45494 174467.74379888, "
            "172757.91194 174470.86979889, "
            "172759.17194 174473.57379889, "
            "172760.30194 174475.99779889, "
            "172767.25694 174472.63279888)))"
        )
        polygon_b = from_wkt(
            "MULTIPOLYGON(((172557.3838523062 174396.45835165278, "
            "172555.12905084348 174410.6693711578, "
            "172554.04105084387 174412.2103631608, "
            "172554.28937084228 174414.93676316369, "
            "172555.0277388468 174423.0425551683, "
            "172563.7369228527 174422.37100316587, "
            "172569.0432908535 174421.9618511684, "
            "172568.4963957805 174415.81728130922, "
            "172568.4972705121 174415.81723898993, "
            "172568.45294000994 174415.31879887995, "
            "172570.64394 174415.21279888996, "
            "172570.64394001 174420.55979889, "
            "172572.08594000997 174420.43979888, "
            "172572.08594000997 174420.94152719184, "
            "172572.77495595193 174420.8841888285, "
            "172572.71193637606 174416.03471118974, "
            "172572.929204253 174416.03280700246, "
            "172572.92794000998 174415.53279887998, "
            "172575.20994000003 174415.51279889, "
            "172575.27294001004 174421.23079888, "
            "172577.6697196799 174421.37078601134, "
            "172577.70199362023 174416.43384416474, "
            "172577.73410833202 174416.4330134905, "
            "172577.7358131635 174415.9674395041, "
            "172577.73594001 174415.93279888004, "
            "172578.87644000998 174415.90329888, "
            "172580.01694000998 174415.87379888, "
            "172579.83694 174420.49979889003, "
            "172581.27894 174420.49979889003, "
            "172581.22540097954 174420.99979889003, "
            "172582.22334147422 174420.99979889003, "
            "172582.17621886 174421.66917916582, "
            "172582.0176908598 174424.652603168, "
            "172581.5430028588 174425.96959516776, "
            "172581.36988285926 174426.44985117015, "
            "172583.22229886055 174426.393211171, "
            "172584.53372231862 174426.04524331444, "
            "172585.60137086362 174425.76191516966, "
            "172589.6888588667 174424.67730716988, "
            "172588.59657086435 174420.30905116722, "
            "172587.97628287587 174417.82828320874, "
            "172587.62773886323 174416.44255516306, "
            "172587.57641086724 174416.43890716136, "
            "172587.6150668636 174415.78034716102, "
            "172587.75349886715 174413.420987159, "
            "172587.86921086907 174411.4484431595, "
            "172591.77150026744 174410.4497097941, "
            "172592.26794067942 174410.3228028141, "
            "172592.57794001006 174412.11779889002, "
            "172593.54694000003 174411.85679889002, "
            "172593.88294001002 174413.17479889, "
            "172596.71693999998 174412.45279888005, "
            "172597.50594000999 174415.42779887991, "
            "172597.172895412 174415.51514718245, "
            "172597.022295644 174415.5546452982, "
            "172597.0224054087 174415.55505917643, "
            "172593.93199883454 174416.33165895962, "
            "172593.94094 174416.36279887997, "
            "172594.31794001002 174417.67579888002, "
            "172595.57994 174417.37579888004, "
            "172595.88594000004 174418.96979887996, "
            "172599.56993999996 174418.29279888, "
            "172600.39494000998 174421.68079888003, "
            "172599.91025387176 174421.80368780546, "
            "172599.94715650496 174421.95523461731, "
            "172596.69628287107 174422.8178511672, "
            "172595.3009759594 174423.18812865848, "
            "172595.67794001 174424.90679888, "
            "172598.81094000905 174424.2187988902, "
            "172598.92996166085 174424.6941881079, "
            "172599.32293973575 174426.26379782447, "
            "172599.32319430308 174426.26481412462, "
            "172599.83993917855 174428.32779556068, "
            "172600.28294000003 174430.09379889, "
            "172599.53294 174430.30379888, "
            "172598.9479399949 174431.12079888713, "
            "172598.50794000993 174431.73679888, "
            "172598.17194137024 174432.53079564194, "
            "172597.70394001 174433.63779889003, "
            "172598.2660748735 174435.35474717614, "
            "172601.1998381591 174434.5913030442, "
            "172601.19995467947 174434.5917172166, "
            "172601.68394000002 174434.46579888, "
            "172602.63794000942 174437.85679888783, "
            "172603.5209395613 174441.3317971537, "
            "172603.67147661696 174441.92469197488, "
            "172604.18799165756 174443.95900234475, "
            "172607.0539523896 174443.2048484512, "
            "172608.01694001004 174447.05779888, "
            "172602.61494001004 174448.18279888007, "
            "172603.57694000003 174451.96779887998, "
            "172591.37294001 174454.98979887998, "
            "172593.09693550566 174460.86278353556, "
            "172605.0632588789 174457.8183631897, "
            "172608.39689087868 174456.97023519131, "
            "172613.0762718963 174455.77972994547, "
            "172613.07636302974 174455.78010138884, "
            "172613.56094001004 174455.65679887997, "
            "172614.32594000004 174458.77479888004, "
            "172609.11894000994 174459.86879888005, "
            "172606.47194360537 174460.59979788712, "
            "172604.45794001 174461.15679888, "
            "172605.3409823247 174464.7719721671, "
            "172612.59480380098 174462.95596724018, "
            "172612.7014123517 174462.92927763195, "
            "172613.07994000003 174462.83479889008, "
            "172613.61893907966 174464.88379535347, "
            "172613.6189968665 174464.88401470726, "
            "172614.04993903125 174466.51979517483, "
            "172614.37794 174467.76679889, "
            "172612.53894704106 174468.36579659986, "
            "172612.53852629993 174468.36593398513, "
            "172611.16394366286 174468.81479768714, "
            "172608.52993999998 174469.67379888, "
            "172609.11193880375 174471.76679455204, "
            "172609.11197085044 174471.76690999718, "
            "172609.56229931235 174473.38928541902, "
            "172609.5649399964 174473.3987988771, "
            "172612.91284623384 174485.5614581992, "
            "172616.49161088464 174484.6038992107, "
            "172617.37810321042 174484.36670035287, "
            "172617.3781038362 174484.3667001854, "
            "172617.40430078932 174484.35969066346, "
            "172621.91801405355 174483.1519558644, "
            "172625.84397284017 174482.10148660126, "
            "172626.28639576584 174481.983107446, "
            "172629.84245889643 174481.0316112079, "
            "172629.84260632202 174481.0318919951, "
            "172641.95148947238 174477.65292460908, "
            "172641.9513229055 174477.65228320664, "
            "172643.55453783524 174477.22348398916, "
            "172649.45557890835 174475.6451792046, "
            "172652.118800357 174474.93285825956, "
            "172655.08757891503 174474.13881120458, "
            "172669.09820291854 174470.39141919912, "
            "172673.91823492196 174469.15141920003, "
            "172674.05039449205 174469.04677954124, "
            "172674.1582349241 174468.9614031985, "
            "172675.5150722086 174468.60274051016, "
            "172675.58914901028 174468.58315924928, "
            "172676.93838271403 174468.22650647085, "
            "172685.4841995281 174465.9675284286, "
            "172690.08649093658 174464.75097119805, "
            "172690.35773174433 174464.679270439, "
            "172693.6036109403 174463.82124319673, "
            "172695.45967493954 174467.2931151986, "
            "172695.69615282057 174467.73546474247, "
            "172695.8858936043 174468.09038905406, "
            "172702.29378802062 174480.0768342967, "
            "172712.67227422315 174477.65895398633, "
            "172712.67215495606 174477.6584912053, "
            "172719.8562189564 174475.80549920353, "
            "172719.13622944942 174473.1791069913, "
            "172719.19547385076 174473.1660017983, "
            "172719.07393999997 174472.68079888003, "
            "172722.78994000095 174471.8587988898, "
            "172723.6209313099 174471.64980106562, "
            "172723.62116079254 174471.6497431358, "
            "172726.34993987996 174470.9607989128, "
            "172727.68514120538 174470.623748284, "
            "172728.34493999486 174470.45779889126, "
            "172728.94593998056 174470.3107988972, "
            "172729.36494001048 174470.20779888984, "
            "172733.29694 174468.74879888006, "
            "172732.51594000997 174463.94179888, "
            "172736.18094000997 174462.86079888, "
            "172736.12094 174460.75779888, "
            "172739.38593999937 174460.04779889015, "
            "172751.74194 174457.62979889003, "
            "172751.82374942137 174457.8052091417, "
            "172760.30108298364 174475.9976912029, "
            "172767.25628262636 174472.6322513803, "
            "172767.5851149932 174472.47314720228, "
            "172767.50690699372 174472.13401120156, "
            "172767.1188087445 174472.3620791199, "
            "172766.30993999983 174470.7767988602, "
            "172765.64794001004 174469.48679887998, "
            "172766.51694001004 174469.12679887997, "
            "172765.12794 174466.03679888998, "
            "172764.34694001 174466.34679888003, "
            "172762.84694005293 174463.15679897126, "
            "172763.29320167168 174462.94189765144, "
            "172764.2839314731 174462.46480300103, "
            "172765.32593999998 174461.96179887993, "
            "172761.1385378274 174453.29491927216, "
            "172761.13853782744 174453.29491927216, "
            "172760.09694000988 174451.01679888976, "
            "172759.79494001003 174450.12279889, "
            "172760.93594000998 174449.76179888003, "
            "172761.82593999995 174450.27579889004, "
            "172762.67400122888 174449.91177263303, "
            "172765.15694 174448.84679888003, "
            "172764.19994000997 174445.99879888, "
            "172764.60994001062 174445.80279888492, "
            "172764.33894001 174444.31479887993, "
            "172763.51689098784 174441.74149918192, "
            "172763.5168882326 174441.74150007046, "
            "172763.51688823258 174441.74150007026, "
            "172763.21993999998 174440.02779889002, "
            "172761.17694 174440.68879888, "
            "172759.74790522835 174436.7047019099, "
            "172755.11890209024 174438.21366147915, "
            "172754.95691696025 174437.6267152474, "
            "172754.85751089564 174437.26601325686, "
            "172754.6069400003 174436.3567988909, "
            "172755.10336595034 174436.22560282986, "
            "172756.19993908802 174435.93579913364, "
            "172758.35593845724 174435.36579929787, "
            "172760.84694000997 174434.70679888004, "
            "172760.58894161868 174433.5358061814, "
            "172760.14693999995 174431.53679888978, "
            "172759.5329400001 174429.6077988801, "
            "172759.52534339868 174429.53306474834, "
            "172759.48582006822 174429.1442406328, "
            "172759.76815493542 174429.05234718855, "
            "172759.7528128644 174429.0162936086, "
            "172759.12745483534 174427.54860076858, "
            "172759.12745462733 174427.54860004058, "
            "172759.1267469823 174427.54693917185, "
            "172759.12695293076 174427.54684410253, "
            "172758.76693612643 174426.28678529424, "
            "172758.12194001 174424.02879888, "
            "172758.32293999995 174423.95879888002, "
            "172758.05193999998 174421.82179889004, "
            "172756.6439400104 174422.12379887994, "
            "172756.53950232168 174422.15535105282, "
            "172755.98194000003 174422.32379888996, "
            "172755.12451175836 174419.47773878835, "
            "172753.83321806323 174419.78523359896, "
            "172752.4939518636 174414.58684488994, "
            "172751.20706697553 174414.83333916217, "
            "172750.73129098117 174412.7877071612, "
            "172748.95247497407 174413.2481231615, "
            "172748.47247497732 174411.39813916016, "
            "172753.23247498277 174410.11813915893, "
            "172751.57647497955 174404.02937115356, "
            "172750.80501897636 174401.19289115068, "
            "172749.21920579113 174395.36230315745, "
            "172749.2194832201 174395.36220860117, "
            "172749.08793999997 174394.87879889001, "
            "172750.24394001003 174394.48479888003, "
            "172751.79493705663 174393.68580041145, "
            "172753.32194001004 174392.89979888, "
            "172754.02694001 174394.06179887996, "
            "172759.86194000999 174390.84279887998, "
            "172760.84694001003 174392.75779887996, "
            "172762.75293454644 174391.80780159816, "
            "172762.7540957816 174391.80722369105, "
            "172764.6779369368 174390.84980040943, "
            "172767.0349380484 174389.675799857, "
            "172769.10393896094 174388.64579940226, "
            "172770.8269400001 174387.78779888, "
            "172772.41231297184 174387.0021096416, "
            "172769.92245898946 174381.99321113512, "
            "172769.86473163788 174381.87794843127, "
            "172766.27740298968 174374.71225113448, "
            "172766.12751504182 174374.37625125528, "
            "172765.45154720507 174372.86111561494, "
            "172764.5623949914 174370.86834713045, "
            "172758.44661898166 174358.71346712485, "
            "172758.08089647835 174357.9866221479, "
            "172758.0812897689 174357.9865175769, "
            "172757.8519399999 174357.5307988898, "
            "172754.4110373197 174349.3873883099, "
            "172754.41083817216 174349.3874620819, "
            "172754.04609390008 174348.52429801252, "
            "172753.7164504677 174347.74419976756, "
            "172753.71289365587 174347.7351269625, "
            "172752.91599497944 174345.84914711493, "
            "172752.96828298277 174345.83532311398, "
            "172752.74697099614 174345.2712271516, "
            "172750.88521097507 174340.5253711095, "
            "172749.90261897308 174337.94073110458, "
            "172742.68309897187 174319.57548309487, "
            "172729.2444429621 174323.76869909838, "
            "172729.1040909663 174323.3482191004, "
            "172719.76546695834 174325.91705109927, "
            "172721.48245895657 174332.9833551049, "
            "172723.08294328308 174339.57013976108, "
            "172723.03791828503 174339.58436050604, "
            "172723.15793999998 174340.07079887998, "
            "172719.07994 174341.35879888994, "
            "172719.0331842302 174340.8492201192, "
            "172718.5874979483 174340.98998616525, "
            "172718.5534989536 174340.6227151118, "
            "172714.9709069505 174341.62623511252, "
            "172702.72073094547 174345.05746711424, "
            "172703.20898694542 174346.73209111392, "
            "172703.9096589461 174349.13503511623, "
            "172695.26953093708 174351.39500311756, "
            "172694.93771905327 174349.74538306356, "
            "172692.57990415473 174350.34580801197, "
            "172692.57334559556 174350.34747709305, "
            "172689.68390132912 174351.0828087242, "
            "172689.6768192437 174351.08460978328, "
            "172686.95894150986 174351.77579850602, "
            "172684.89594078047 174352.3007986814, "
            "172684.8828689878 174352.30412604674, "
            "172683.3009262921 174352.70680236846, "
            "172681.18281584515 174353.24583040207, "
            "172679.3319479569 174353.71579686215, "
            "172677.40094000465 174354.20779888882, "
            "172677.27266865686 174353.73419735025, "
            "172676.77394073328 174351.89280155062, "
            "172676.06193873903 174349.26679423897, "
            "172675.7409324217 174348.08277088706, "
            "172675.25994054292 174346.30780088357, "
            "172675.2596599193 174346.30676614863, "
            "172674.46692653303 174343.38374918967, "
            "172673.58194064876 174340.11780124725, "
            "172672.77094000002 174337.12779888004, "
            "172670.9499049531 174337.60880813404, "
            "172670.52563620973 174337.72080595847, "
            "172669.09919766168 174338.09735505903, "
            "172669.08994002102 174338.09979887708, "
            "172668.25594001057 174338.3197988899, "
            "172663.54094 174339.43779888, "
            "172663.9509396747 174340.9917976469, "
            "172663.95246609734 174340.9975798821, "
            "172664.37093995474 174342.5827987186, "
            "172664.9449393093 174344.75679626403, "
            "172665.47293987044 174346.75879839866, "
            "172665.473080069 174346.7593299183, "
            "172666.08593904617 174349.08279523588, "
            "172666.0860074876 174349.08305431984, "
            "172666.77093856825 174351.67579347026, "
            "172667.44093999997 174354.21779888, "
            "172665.21794001 174354.76179888, "
            "172665.0101183685 174354.8126524625, "
            "172663.37894000002 174355.21179888002, "
            "172663.37873282918 174355.21184957805, "
            "172661.5809427116 174355.65179822646, "
            "172659.15894248072 174356.2437982761, "
            "172656.24094000997 174356.95779889004, "
            "172655.8289405051 174354.98780124754, "
            "172655.30694000996 174352.49479888997, "
            "172654.75393999997 174349.85379887992, "
            "172653.44093999994 174347.26779887994, "
            "172650.79094000012 174346.37779887998, "
            "172649.39294039877 174346.74579877505, "
            "172649.3911846923 174346.7462610297, "
            "172648.1699417751 174347.06779842527, "
            "172643.14494001 174348.38979889, "
            "172642.93389291374 174348.44532466854, "
            "172640.56794000996 174349.06779889, "
            "172640.41789637046 174349.10727144754, "
            "172638.06294 174349.72679888003, "
            "172635.8089427633 174350.319798163, "
            "172634.01694338908 174350.79179799, "
            "172631.56094000998 174351.43779888997, "
            "172631.68094001 174351.69779888, "
            "172630.46894738195 174352.0517967368, "
            "172630.4687520214 174352.05185395735, "
            "172629.2809437475 174352.39979778518, "
            "172627.68094000997 174352.86779889, "
            "172628.10093847304 174354.1197943085, "
            "172628.10107294662 174354.1201945294, "
            "172628.6879379874 174355.86679290008, "
            "172628.68799114702 174355.86695143604, "
            "172629.43093933648 174358.08279688127, "
            "172629.43133035954 174358.0839622848, "
            "172630.24693959064 174360.5147976402, "
            "172630.24792235918 174360.51772822303, "
            "172630.85693939638 174362.3337970801, "
            "172631.76094 174365.02779888996, "
            "172632.43094001003 174364.86779888996, "
            "172632.93494001002 174366.67479888993, "
            "172630.87694000924 174367.2867988902, "
            "172629.35094510994 174367.69579751312, "
            "172629.35049890392 174367.69591735688, "
            "172627.54894514213 174368.17979751158, "
            "172627.52128803954 174368.18721035263, "
            "172625.4409402792 174368.7447988152, "
            "172625.43971959242 174368.74512604062, "
            "172623.82194391786 174369.17879783243, "
            "172621.82194405483 174369.715797794, "
            "172621.82183787943 174369.71582625585, "
            "172620.13194178292 174370.16879840213, "
            "172618.52894290345 174370.59879811114, "
            "172616.85694000009 174371.04679887995, "
            "172613.67694 174372.43679888, "
            "172612.2709414281 174372.87179843814, "
            "172610.70894325845 174373.35479788246, "
            "172608.85694 174373.92679889, "
            "172608.25794049533 174371.89080052968, "
            "172607.82694000003 174370.42679889002, "
            "172607.51030628625 174370.515852122, "
            "172607.38694001004 174370.06679887997, "
            "172607.01194001 174368.70179888996, "
            "172605.61394000004 174369.12679888998, "
            "172604.29194001 174364.49979887996, "
            "172605.79494001003 174364.27579888995, "
            "172604.95794001003 174361.23079889003, "
            "172604.15693999996 174358.31679887997, "
            "172601.3829428521 174359.08279810517, "
            "172600.24729543962 174359.3960325686, "
            "172597.84457264078 174350.6279695617, "
            "172597.51694001004 174350.71679888997, "
            "172593.94294000993 174351.68579889, "
            "172594.4599387648 174353.5957943269, "
            "172594.89194001 174355.18879888, "
            "172594.43694 174355.28679888998, "
            "172595.10393895835 174357.58879525043, "
            "172595.61693890326 174359.35679511022, "
            "172596.36993943545 174361.95579694142, "
            "172596.92693999998 174363.87679887997, "
            "172594.25694 174364.45679887995, "
            "172594.21693999998 174364.31679888006, "
            "172593.00494592657 174364.6537972349, "
            "172593.00452690053 174364.65391402238, "
            "172592.00394302807 174364.932798036, "
            "172590.26894162453 174365.41579843775, "
            "172588.36994388918 174365.94479780665, "
            "172588.36984125132 174365.94482635465, "
            "172586.29894001002 174366.52079888002, "
            "172585.7109407086 174364.2888015419, "
            "172585.71082483808 174364.2883622034, "
            "172585.01994076036 174361.66880173524, "
            "172584.8667329185 174361.0872324162, "
            "172584.37794 174359.23179888996, "
            "172583.4569404406 174355.73580051467, "
            "172582.56193999999 174352.34079887997, "
            "172581.81194 174349.49579887997, "
            "172578.96056568567 174350.36739802494, "
            "172585.1382444169 174374.19050227254, "
            "172585.0614705477 174374.21335843968, "
            "172585.18994 174374.69679888996, "
            "172581.69994000997 174375.73579888, "
            "172581.62350512363 174375.3929519558, "
            "172581.93994000004 174374.65479888, "
            "172582.48094 174373.39279888003, "
            "172580.61794 174366.54279888, "
            "172576.77667659082 174367.3948403584, "
            "172578.3008907684 174373.35775476237, "
            "172578.52405885607 174374.23071513322, "
            "172580.47195049844 174381.85118837637, "
            "172580.4625612569 174381.85333750857, "
            "172580.58694000004 174382.33779888, "
            "172578.45494 174382.82579888, "
            "172576.95294001 174376.09679888003, "
            "172576.23194 174376.15679888002, "
            "172575.20993999997 174372.55179889, "
            "172573.66458694366 174372.8308626458, "
            "172574.0934668556 174374.3819471337, "
            "172574.33365876754 174375.25074680167, "
            "172574.7994377378 174376.93505831185, "
            "172574.46694027368 174377.10679874866, "
            "172573.55473542705 174377.38586125555, "
            "172571.95794220705 174377.87279822002, "
            "172569.12694000997 174378.73679888004, "
            "172570.29693999997 174382.59679888, "
            "172569.06894000657 174382.95779888806, "
            "172568.98899089158 174382.9810527852, "
            "172567.62494267538 174383.37779810186, "
            "172566.1759413303 174383.7987985035, "
            "172564.9709467131 174384.14879693012, "
            "172563.53494001646 174384.5647988781, "
            "172562.23594001002 174384.94279888997, "
            "172561.03905731053 174385.28960586703, "
            "172554.56188284606 174386.74853914225, "
            "172555.21404284242 174388.99244314435, "
            "172557.3838523062 174396.45835165278)),"
            "((172739.38594000007 174460.04779889, "
            "172739.39373637483 174460.04610350684, "
            "172739.392673916 174460.04121769255, "
            "172739.3870486459 174460.03837656736, "
            "172739.38261013498 174460.0403655549, "
            "172739.3807950899 174460.03631378766, "
            "172739.37623201194 174460.03835788142, "
            "172739.37262919155 174460.04530889943, "
            "172739.37358944913 174460.05021582366, "
            "172739.3858038434 174460.04782553512, "
            "172739.3859399994 174460.04779889015, "
            "172739.38594000007 174460.04779889)))"
        )
        result = safe_union(polygon_a, polygon_b)  # GEOS exception is caught
        self.assertTrue(result.is_valid)

    def test_safe_intersection(self):
        """Tests safe_intersection with two disjoint polygons."""
        polygon_a = Polygon([(0, 0), (1, 0), (1, 1), (0, 1)])
        polygon_b = Polygon([(2, 2), (3, 2), (3, 3), (2, 3)])
        result = safe_intersection(polygon_a, polygon_b)
        self.assertEqual(result, Polygon())

    def test_safe_intersection_geos_exception(self):
        """Tests safe_intersection with a geos exception."""

        polygon_a = from_wkt(
            "MULTIPOLYGON(((172767.25694 174472.63279888, "
            "172766.30994001 174470.77679888, "
            "172765.64794001 174469.48679888, "
            "172766.51694001 174469.12679888, "
            "172765.12794 174466.03679889, "
            "172764.34694001 174466.34679888, "
            "172762.84694001 174463.15679888, "
            "172764.28394001 174462.46479889, "
            "172765.32594 174461.96179888, "
            "172761.13894 174453.29579888, "
            "172760.09694001 174451.01679889, "
            "172759.79494001 174450.12279889, "
            "172760.93594001 174449.76179888, "
            "172761.82594 174450.27579889, "
            "172762.67394001 174449.91179889, "
            "172765.15694 174448.84679888, "
            "172764.19994001 174445.99879888, "
            "172764.60994 174445.80279889, "
            "172764.33894001 174444.31479888, "
            "172763.51694001 174441.74179888, "
            "172763.21994 174440.02779889, "
            "172761.17694 174440.68879888, "
            "172759.74794001 174436.70479888, "
            "172759.02694001 174436.93979888, "
            "172756.96694 174437.61179889, "
            "172755.11894001 174438.21379888, "
            "172754.95694001 174437.62679889, "
            "172754.60694 174436.35679889, "
            "172756.19994001 174435.93579889, "
            "172758.35594 174435.36579889, "
            "172760.84694001 174434.70679888, "
            "172760.58894001 174433.53579888, "
            "172760.14694 174431.53679889, "
            "172759.53294 174429.60779888, "
            "172759.38494 174428.15179888, "
            "172759.12694001 174427.54679888, "
            "172758.76694001 174426.28679889, "
            "172758.12194001 174424.02879888, "
            "172758.32294 174423.95879888, "
            "172758.05194 174421.82179889, "
            "172756.64394001 174422.12379888, "
            "172755.98194 174422.32379889, "
            "172755.12694001 174419.48579888, "
            "172753.83594001 174419.79579889, "
            "172752.49394001 174414.58679888, "
            "172751.20794001 174414.83379888, "
            "172750.65294001 174412.80779888, "
            "172748.95294001 174413.24779889, "
            "172748.47294 174411.39879889, "
            "172753.23294001 174410.11879888, "
            "172752.77094 174408.42079889, "
            "172752.20594 174406.34079888, "
            "172751.57694 174404.02979888, "
            "172750.94994001 174401.72379889, "
            "172750.44494 174399.86779889, "
            "172749.65394 174396.95879888, "
            "172749.08794 174394.87879889, "
            "172750.24394001 174394.48479888, "
            "172751.79494001 174393.68579889, "
            "172753.32194001 174392.89979888, "
            "172754.02694001 174394.06179888, "
            "172759.86194001 174390.84279888, "
            "172760.84694001 174392.75779888, "
            "172762.75294 174391.80779888, "
            "172764.67794001 174390.84979888, "
            "172767.03494001 174389.67579888, "
            "172769.10394001 174388.64579888, "
            "172770.82694 174387.78779888, "
            "172772.41294001 174387.00179889, "
            "172771.70694001 174385.58179888, "
            "172770.47494001 174383.10379888, "
            "172769.86494001 174381.87779888, "
            "172769.31094001 174380.77179889, "
            "172768.51694001 174379.18579889, "
            "172767.43494001 174377.02279888, "
            "172766.27794001 174374.71279889, "
            "172765.78994 174373.61879888, "
            "172765.24294 174372.39279888, "
            "172764.56294 174370.86879888, "
            "172763.48394 174368.72379889, "
            "172762.58994001 174366.94779889, "
            "172761.36994 174364.52279888, "
            "172760.27094 174362.33879888, "
            "172759.15994001 174360.12979888, "
            "172757.85194 174357.53079889, "
            "172752.91594 174345.84979888, "
            "172752.44494 174344.50079888, "
            "172751.68294 174342.55779888, "
            "172750.88594 174340.52579889, "
            "172749.87694001 174337.94779888, "
            "172748.82694 174335.20279888, "
            "172747.72094 174332.38879888, "
            "172746.51294001 174329.31579889, "
            "172745.36494001 174326.39779888, "
            "172743.82194001 174322.47179888, "
            "172742.68394 174319.57579888, "
            "172739.86294 174320.46079888, "
            "172737.67194 174320.96779888, "
            "172736.12194001 174321.39879889, "
            "172733.90294001 174322.01479889, "
            "172731.21594 174322.76179888, "
            "172729.70094 174323.15779889, "
            "172729.10494001 174323.34879888, "
            "172727.50294 174323.86079888, "
            "172724.60494001 174324.78679888, "
            "172719.82894001 174326.31279889, "
            "172720.17794001 174327.77779889, "
            "172720.41094 174328.75779888, "
            "172720.82494001 174330.49979889, "
            "172721.08494 174331.56079889, "
            "172721.42594 174332.98579888, "
            "172721.70594 174334.18179888, "
            "172722.03394001 174335.51479889, "
            "172722.60994 174337.84979888, "
            "172723.15794 174340.07079888, "
            "172719.07994 174341.35879889, "
            "172719.00094001 174340.49779889, "
            "172718.62994001 174340.60179888, "
            "172717.50294 174340.91679888, "
            "172714.97094 174341.62679888, "
            "172714.17294 174341.84979888, "
            "172712.47094 174342.32679888, "
            "172710.41394001 174342.90279889, "
            "172708.33894001 174343.48379889, "
            "172705.43894001 174344.29679888, "
            "172702.72094 174345.05779888, "
            "172703.36294 174347.25779888, "
            "172703.90994001 174349.13479888, "
            "172702.14294 174349.59779889, "
            "172700.29694 174350.08079888, "
            "172697.39194001 174350.83979889, "
            "172695.26994001 174351.39479888, "
            "172694.94394 174349.74379888, "
            "172692.57994 174350.34579889, "
            "172689.68394 174351.08279889, "
            "172686.95894 174351.77579889, "
            "172684.89594 174352.30079888, "
            "172683.30094 174352.70679888, "
            "172681.18294 174353.24579888, "
            "172679.33194001 174353.71579888, "
            "172677.40094 174354.20779889, "
            "172676.77394001 174351.89279888, "
            "172676.06194 174349.26679889, "
            "172675.74094001 174348.08279889, "
            "172675.25994 174346.30779888, "
            "172674.46694 174343.38379889, "
            "172673.58194001 174340.11779889, "
            "172672.77094 174337.12779888, "
            "172670.94994001 174337.60879888, "
            "172669.08994001 174338.09979888, "
            "172668.25594001 174338.31979889, "
            "172663.54094 174339.43779888, "
            "172663.95094 174340.99179888, "
            "172664.37094 174342.58279889, "
            "172664.94494 174344.75679888, "
            "172665.47294 174346.75879889, "
            "172666.08594001 174349.08279889, "
            "172666.77094 174351.67579889, "
            "172667.44094 174354.21779888, "
            "172665.21794001 174354.76179888, "
            "172663.37894 174355.21179888, "
            "172661.58094 174355.65179889, "
            "172659.15894001 174356.24379888, "
            "172656.24094001 174356.95779889, "
            "172655.82894001 174354.98779888, "
            "172655.30694001 174352.49479889, "
            "172654.75394 174349.85379888, "
            "172653.44094 174347.26779888, "
            "172650.79094 174346.37779888, "
            "172649.39294 174346.74579888, "
            "172648.16994001 174347.06779889, "
            "172643.14494001 174348.38979889, "
            "172640.56794001 174349.06779889, "
            "172638.06294 174349.72679888, "
            "172635.80894 174350.31979889, "
            "172634.01694001 174350.79179888, "
            "172631.56094001 174351.43779889, "
            "172631.68094001 174351.69779888, "
            "172630.46894001 174352.05179889, "
            "172629.28094001 174352.39979888, "
            "172627.68094001 174352.86779889, "
            "172628.10094001 174354.11979889, "
            "172628.68794 174355.86679889, "
            "172629.43094001 174358.08279889, "
            "172630.24694001 174360.51479889, "
            "172630.85694 174362.33379888, "
            "172631.76094 174365.02779889, "
            "172632.43094001 174364.86779889, "
            "172632.93494001 174366.67479889, "
            "172630.87694001 174367.28679889, "
            "172629.35094001 174367.69579888, "
            "172627.54894001 174368.17979889, "
            "172625.44094 174368.74479889, "
            "172623.82194001 174369.17879888, "
            "172621.82194001 174369.71579888, "
            "172620.13194 174370.16879888, "
            "172618.52894 174370.59879889, "
            "172616.85694 174371.04679888, "
            "172613.67694 174372.43679888, "
            "172612.27094 174372.87179888, "
            "172610.70894 174373.35479889, "
            "172608.85694 174373.92679889, "
            "172608.25794001 174371.89079888, "
            "172607.82694 174370.42679889, "
            "172607.50694 174370.51679889, "
            "172607.38694001 174370.06679888, "
            "172607.01194001 174368.70179889, "
            "172605.61394 174369.12679889, "
            "172604.29194001 174364.49979888, "
            "172605.79494001 174364.27579889, "
            "172604.95794001 174361.23079889, "
            "172604.15694 174358.31679888, "
            "172601.38294001 174359.08279889, "
            "172599.73694001 174359.53679889, "
            "172599.03094001 174356.96479888, "
            "172598.45694001 174354.87679889, "
            "172598.31094001 174353.65579888, "
            "172597.92494001 174352.22579889, "
            "172597.51694001 174350.71679889, "
            "172593.94294001 174351.68579889, "
            "172594.45994 174353.59579889, "
            "172594.89194001 174355.18879888, "
            "172594.43694 174355.28679889, "
            "172595.10394001 174357.58879888, "
            "172595.61694 174359.35679889, "
            "172596.36994 174361.95579889, "
            "172596.92694 174363.87679888, "
            "172594.25694 174364.45679888, "
            "172594.21694 174364.31679888, "
            "172593.00494001 174364.65379888, "
            "172592.00394 174364.93279888, "
            "172590.26894 174365.41579889, "
            "172588.36994 174365.94479889, "
            "172586.29894001 174366.52079888, "
            "172585.71094001 174364.28879889, "
            "172585.01994001 174361.66879889, "
            "172584.37794 174359.23179889, "
            "172583.45694001 174355.73579888, "
            "172582.56194 174352.34079888, "
            "172581.81194 174349.49579888, "
            "172578.83494 174350.40579889, "
            "172579.40794 174352.63579888, "
            "172579.78994 174354.11679888, "
            "172580.28794001 174356.05279889, "
            "172580.77094 174357.92779888, "
            "172581.47694 174360.66679888, "
            "172581.97094 174362.58679888, "
            "172582.24294 174363.61779889, "
            "172582.54194001 174364.74379888, "
            "172582.91294001 174366.13879888, "
            "172583.24094001 174367.37179888, "
            "172583.56894 174368.60379888, "
            "172583.98394 174370.16379889, "
            "172584.46094001 174371.95479888, "
            "172584.86494001 174373.47379888, "
            "172585.18994 174374.69679889, "
            "172581.69994001 174375.73579888, "
            "172581.45894 174374.65479888, "
            "172581.93994 174374.65479888, "
            "172582.48094 174373.39279888, "
            "172580.61794 174366.54279888, "
            "172576.54694 174367.44579888, "
            "172576.96094001 174368.82979888, "
            "172577.49594 174370.61579889, "
            "172578.20294001 174372.70579888, "
            "172578.57394 174374.21879889, "
            "172578.69794 174374.72879888, "
            "172578.94194001 174375.71979888, "
            "172579.21594 174376.83779888, "
            "172579.48694001 174377.94179888, "
            "172579.78194 174379.14479889, "
            "172580.08194001 174380.37079888, "
            "172580.58694 174382.33779888, "
            "172578.45494 174382.82579888, "
            "172576.95294001 174376.09679888, "
            "172576.23194 174376.15679888, "
            "172575.20994 174372.55179889, "
            "172573.66494 174372.83079889, "
            "172574.33394 174375.25079888, "
            "172574.79994001 174376.93479888, "
            "172574.46694 174377.10679889, "
            "172573.55494 174377.38579888, "
            "172571.95794001 174377.87279889, "
            "172569.12694001 174378.73679888, "
            "172570.29694 174382.59679888, "
            "172569.06894 174382.95779889, "
            "172567.62494 174383.37779888, "
            "172566.17594 174383.79879889, "
            "172564.97094 174384.14879888, "
            "172563.53494001 174384.56479888, "
            "172562.23594001 174384.94279889, "
            "172561.03494001 174385.29079889, "
            "172559.35194 174385.66979888, "
            "172558.39794001 174385.88479888, "
            "172556.63694001 174386.28179888, "
            "172554.56194 174386.74879888, "
            "172554.93394 174388.02679888, "
            "172555.33194001 174389.39779888, "
            "172555.78394001 174390.95079888, "
            "172556.25094001 174392.55979888, "
            "172556.78094001 174394.38279888, "
            "172557.38394001 174396.45779889, "
            "172555.12994001 174410.66979888, "
            "172554.04194001 174412.21079889, "
            "172554.18094001 174413.74279889, "
            "172554.35894 174415.69279889, "
            "172554.59094 174418.23979888, "
            "172554.80294001 174420.57479888, "
            "172555.02794001 174423.04279888, "
            "172555.93294 174422.97279889, "
            "172557.54494001 174422.84879889, "
            "172560.00094001 174422.89679889, "
            "172562.04294 174422.83779889, "
            "172563.99094001 174422.77979888, "
            "172565.29094 174422.74079889, "
            "172567.21594 174422.68179889, "
            "172569.10194 174422.62379888, "
            "172568.98294001 174421.27879888, "
            "172568.88094001 174420.13579889, "
            "172568.73194 174418.45579889, "
            "172568.45294001 174415.31879888, "
            "172570.64394 174415.21279889, "
            "172570.64394001 174420.55979889, "
            "172572.08594001 174420.43979888, "
            "172572.08594001 174421.46179888, "
            "172572.89894001 174421.52179889, "
            "172572.93594001 174418.69679889, "
            "172572.92794001 174415.53279888, "
            "172575.20994 174415.51279889, "
            "172575.27294001 174421.23079888, "
            "172577.66994001 174421.37079888, "
            "172577.71794001 174420.68179889, "
            "172577.72494001 174418.93679889, "
            "172577.73594001 174415.93279888, "
            "172580.01694001 174415.87379888, "
            "172579.83694 174420.49979889, "
            "172581.27894 174420.49979889, "
            "172581.16094 174421.60179888, "
            "172582.17694 174421.66979888, "
            "172582.13594 174422.43279888, "
            "172582.06294 174423.81779889, "
            "172581.85494001 174425.10579888, "
            "172581.54394 174425.96979888, "
            "172582.27094 174425.90879888, "
            "172583.34994001 174425.81679888, "
            "172584.44594001 174425.72479888, "
            "172585.57394 174425.43879889, "
            "172587.27294001 174425.00679888, "
            "172589.82794001 174424.35879889, "
            "172589.40294001 174423.53179888, "
            "172589.03494001 174422.06079888, "
            "172588.59694001 174420.30879889, "
            "172588.35594 174419.34679888, "
            "172587.97694 174417.82879889, "
            "172587.78294 174417.05679889, "
            "172587.61594001 174415.77979888, "
            "172587.36494001 174414.35979888, "
            "172587.75394 174413.42079888, "
            "172587.86994 174411.44879889, "
            "172592.26794 174410.32279888, "
            "172592.57794001 174412.11779889, "
            "172593.54694 174411.85679889, "
            "172593.88294001 174413.17479889, "
            "172596.71694 174412.45279888, "
            "172597.50594001 174415.42779888, "
            "172593.94094 174416.36279888, "
            "172594.31794001 174417.67579888, "
            "172595.57994 174417.37579888, "
            "172595.88594 174418.96979888, "
            "172599.56994 174418.29279888, "
            "172600.39494001 174421.68079888, "
            "172599.12494 174422.00279888, "
            "172597.83994001 174422.32779888, "
            "172595.25594001 174422.98279888, "
            "172595.67794001 174424.90679888, "
            "172598.81094001 174424.21879889, "
            "172599.32294 174426.26379888, "
            "172599.83994001 174428.32779888, "
            "172600.28294 174430.09379889, "
            "172599.53294 174430.30379888, "
            "172598.94794 174431.12079888, "
            "172598.50794001 174431.73679888, "
            "172598.17194 174432.53079888, "
            "172597.70394001 174433.63779889, "
            "172598.26694001 174435.35479889, "
            "172601.68394 174434.46579888, "
            "172602.63794001 174437.85679889, "
            "172603.52094 174441.33179888, "
            "172604.18794 174443.95879889, "
            "172607.05394 174443.20479888, "
            "172608.01694001 174447.05779888, "
            "172602.61494001 174448.18279888, "
            "172603.57694 174451.96779888, "
            "172591.37294001 174454.98979888, "
            "172593.09694001 174460.86279888, "
            "172596.00694 174460.12279889, "
            "172599.45294001 174459.24579888, "
            "172605.06394001 174457.81879888, "
            "172608.39694 174456.97079889, "
            "172613.56094001 174455.65679888, "
            "172614.32594 174458.77479888, "
            "172609.11894001 174459.86879888, "
            "172606.47194001 174460.59979888, "
            "172604.45794001 174461.15679888, "
            "172605.34094 174464.77179889, "
            "172607.57394 174464.20979889, "
            "172609.99094001 174463.60579889, "
            "172613.07994 174462.83479889, "
            "172613.61894001 174464.88379889, "
            "172614.04994001 174466.51979889, "
            "172614.37794 174467.76679889, "
            "172612.53894001 174468.36579889, "
            "172611.16394001 174468.81479888, "
            "172608.52994 174469.67379888, "
            "172609.11194001 174471.76679889, "
            "172609.56494 174473.39879889, "
            "172612.91294001 174485.56179888, "
            "172614.59894 174485.11079888, "
            "172617.38894 174484.36379889, "
            "172622.33194001 174483.04179888, "
            "172625.99594 174482.06079889, "
            "172629.84294001 174481.03179888, "
            "172641.95194 174477.65279889, "
            "172643.75494001 174477.16979888, "
            "172645.38894 174476.73279888, "
            "172647.53094001 174476.15979889, "
            "172649.87894 174475.53179888, "
            "172652.14894001 174474.92479889, "
            "172655.08794 174474.13879889, "
            "172656.82294 174473.67479889, "
            "172659.20494 174473.03779889, "
            "172661.12994001 174472.52279888, "
            "172663.13094001 174471.98779888, "
            "172666.07294 174471.20079888, "
            "172669.09894 174470.39179889, "
            "172670.32794001 174470.07579888, "
            "172672.24694001 174469.58179889, "
            "172673.91894 174469.15179888, "
            "172674.58694 174468.84879889, "
            "172675.52994 174468.59879889, "
            "172677.88094001 174467.97779889, "
            "172680.51794 174467.28079889, "
            "172683.39194001 174466.52079888, "
            "172686.88994 174465.59579889, "
            "172690.08694 174464.75079888, "
            "172693.60394001 174463.82179889, "
            "172694.71594 174465.90079889, "
            "172695.81494 174467.95779889, "
            "172696.76694001 174469.73679889, "
            "172698.74294 174473.43379889, "
            "172700.00894001 174475.80279888, "
            "172701.21194 174478.05279888, "
            "172702.29394 174480.07679889, "
            "172712.67294 174477.65879888, "
            "172714.31294 174477.23479888, "
            "172715.92294 174476.81879889, "
            "172718.15094 174476.24279889, "
            "172719.85594 174475.80279888, "
            "172719.07394 174472.68079888, "
            "172722.78994 174471.85879889, "
            "172723.62094 174471.64979888, "
            "172726.34994001 174470.96079888, "
            "172727.68494001 174470.62379888, "
            "172728.34494 174470.45779889, "
            "172728.94594001 174470.31079889, "
            "172729.36494001 174470.20779889, "
            "172733.29694 174468.74879888, "
            "172732.51594001 174463.94179888, "
            "172736.18094001 174462.86079888, "
            "172736.12094 174460.75779888, "
            "172739.38594 174460.04779889, "
            "172751.74194 174457.62979889, "
            "172752.52594 174459.31079889, "
            "172753.47194001 174461.34079888, "
            "172754.32394 174463.17079889, "
            "172755.22994001 174465.11479888, "
            "172756.45494 174467.74379888, "
            "172757.91194 174470.86979889, "
            "172759.17194 174473.57379889, "
            "172760.30194 174475.99779889, "
            "172767.25694 174472.63279888)))"
        )
        polygon_b = from_wkt(
            "MULTIPOLYGON(((172557.3838523062 174396.45835165278, "
            "172555.12905084348 174410.6693711578, "
            "172554.04105084387 174412.2103631608, "
            "172554.28937084228 174414.93676316369, "
            "172555.0277388468 174423.0425551683, "
            "172563.7369228527 174422.37100316587, "
            "172569.0432908535 174421.9618511684, "
            "172568.4963957805 174415.81728130922, "
            "172568.4972705121 174415.81723898993, "
            "172568.45294000994 174415.31879887995, "
            "172570.64394 174415.21279888996, "
            "172570.64394001 174420.55979889, "
            "172572.08594000997 174420.43979888, "
            "172572.08594000997 174420.94152719184, "
            "172572.77495595193 174420.8841888285, "
            "172572.71193637606 174416.03471118974, "
            "172572.929204253 174416.03280700246, "
            "172572.92794000998 174415.53279887998, "
            "172575.20994000003 174415.51279889, "
            "172575.27294001004 174421.23079888, "
            "172577.6697196799 174421.37078601134, "
            "172577.70199362023 174416.43384416474, "
            "172577.73410833202 174416.4330134905, "
            "172577.7358131635 174415.9674395041, "
            "172577.73594001 174415.93279888004, "
            "172578.87644000998 174415.90329888, "
            "172580.01694000998 174415.87379888, "
            "172579.83694 174420.49979889003, "
            "172581.27894 174420.49979889003, "
            "172581.22540097954 174420.99979889003, "
            "172582.22334147422 174420.99979889003, "
            "172582.17621886 174421.66917916582, "
            "172582.0176908598 174424.652603168, "
            "172581.5430028588 174425.96959516776, "
            "172581.36988285926 174426.44985117015, "
            "172583.22229886055 174426.393211171, "
            "172584.53372231862 174426.04524331444, "
            "172585.60137086362 174425.76191516966, "
            "172589.6888588667 174424.67730716988, "
            "172588.59657086435 174420.30905116722, "
            "172587.97628287587 174417.82828320874, "
            "172587.62773886323 174416.44255516306, "
            "172587.57641086724 174416.43890716136, "
            "172587.6150668636 174415.78034716102, "
            "172587.75349886715 174413.420987159, "
            "172587.86921086907 174411.4484431595, "
            "172591.77150026744 174410.4497097941, "
            "172592.26794067942 174410.3228028141, "
            "172592.57794001006 174412.11779889002, "
            "172593.54694000003 174411.85679889002, "
            "172593.88294001002 174413.17479889, "
            "172596.71693999998 174412.45279888005, "
            "172597.50594000999 174415.42779887991, "
            "172597.172895412 174415.51514718245, "
            "172597.022295644 174415.5546452982, "
            "172597.0224054087 174415.55505917643, "
            "172593.93199883454 174416.33165895962, "
            "172593.94094 174416.36279887997, "
            "172594.31794001002 174417.67579888002, "
            "172595.57994 174417.37579888004, "
            "172595.88594000004 174418.96979887996, "
            "172599.56993999996 174418.29279888, "
            "172600.39494000998 174421.68079888003, "
            "172599.91025387176 174421.80368780546, "
            "172599.94715650496 174421.95523461731, "
            "172596.69628287107 174422.8178511672, "
            "172595.3009759594 174423.18812865848, "
            "172595.67794001 174424.90679888, "
            "172598.81094000905 174424.2187988902, "
            "172598.92996166085 174424.6941881079, "
            "172599.32293973575 174426.26379782447, "
            "172599.32319430308 174426.26481412462, "
            "172599.83993917855 174428.32779556068, "
            "172600.28294000003 174430.09379889, "
            "172599.53294 174430.30379888, "
            "172598.9479399949 174431.12079888713, "
            "172598.50794000993 174431.73679888, "
            "172598.17194137024 174432.53079564194, "
            "172597.70394001 174433.63779889003, "
            "172598.2660748735 174435.35474717614, "
            "172601.1998381591 174434.5913030442, "
            "172601.19995467947 174434.5917172166, "
            "172601.68394000002 174434.46579888, "
            "172602.63794000942 174437.85679888783, "
            "172603.5209395613 174441.3317971537, "
            "172603.67147661696 174441.92469197488, "
            "172604.18799165756 174443.95900234475, "
            "172607.0539523896 174443.2048484512, "
            "172608.01694001004 174447.05779888, "
            "172602.61494001004 174448.18279888007, "
            "172603.57694000003 174451.96779887998, "
            "172591.37294001 174454.98979887998, "
            "172593.09693550566 174460.86278353556, "
            "172605.0632588789 174457.8183631897, "
            "172608.39689087868 174456.97023519131, "
            "172613.0762718963 174455.77972994547, "
            "172613.07636302974 174455.78010138884, "
            "172613.56094001004 174455.65679887997, "
            "172614.32594000004 174458.77479888004, "
            "172609.11894000994 174459.86879888005, "
            "172606.47194360537 174460.59979788712, "
            "172604.45794001 174461.15679888, "
            "172605.3409823247 174464.7719721671, "
            "172612.59480380098 174462.95596724018, "
            "172612.7014123517 174462.92927763195, "
            "172613.07994000003 174462.83479889008, "
            "172613.61893907966 174464.88379535347, "
            "172613.6189968665 174464.88401470726, "
            "172614.04993903125 174466.51979517483, "
            "172614.37794 174467.76679889, "
            "172612.53894704106 174468.36579659986, "
            "172612.53852629993 174468.36593398513, "
            "172611.16394366286 174468.81479768714, "
            "172608.52993999998 174469.67379888, "
            "172609.11193880375 174471.76679455204, "
            "172609.11197085044 174471.76690999718, "
            "172609.56229931235 174473.38928541902, "
            "172609.5649399964 174473.3987988771, "
            "172612.91284623384 174485.5614581992, "
            "172616.49161088464 174484.6038992107, "
            "172617.37810321042 174484.36670035287, "
            "172617.3781038362 174484.3667001854, "
            "172617.40430078932 174484.35969066346, "
            "172621.91801405355 174483.1519558644, "
            "172625.84397284017 174482.10148660126, "
            "172626.28639576584 174481.983107446, "
            "172629.84245889643 174481.0316112079, "
            "172629.84260632202 174481.0318919951, "
            "172641.95148947238 174477.65292460908, "
            "172641.9513229055 174477.65228320664, "
            "172643.55453783524 174477.22348398916, "
            "172649.45557890835 174475.6451792046, "
            "172652.118800357 174474.93285825956, "
            "172655.08757891503 174474.13881120458, "
            "172669.09820291854 174470.39141919912, "
            "172673.91823492196 174469.15141920003, "
            "172674.05039449205 174469.04677954124, "
            "172674.1582349241 174468.9614031985, "
            "172675.5150722086 174468.60274051016, "
            "172675.58914901028 174468.58315924928, "
            "172676.93838271403 174468.22650647085, "
            "172685.4841995281 174465.9675284286, "
            "172690.08649093658 174464.75097119805, "
            "172690.35773174433 174464.679270439, "
            "172693.6036109403 174463.82124319673, "
            "172695.45967493954 174467.2931151986, "
            "172695.69615282057 174467.73546474247, "
            "172695.8858936043 174468.09038905406, "
            "172702.29378802062 174480.0768342967, "
            "172712.67227422315 174477.65895398633, "
            "172712.67215495606 174477.6584912053, "
            "172719.8562189564 174475.80549920353, "
            "172719.13622944942 174473.1791069913, "
            "172719.19547385076 174473.1660017983, "
            "172719.07393999997 174472.68079888003, "
            "172722.78994000095 174471.8587988898, "
            "172723.6209313099 174471.64980106562, "
            "172723.62116079254 174471.6497431358, "
            "172726.34993987996 174470.9607989128, "
            "172727.68514120538 174470.623748284, "
            "172728.34493999486 174470.45779889126, "
            "172728.94593998056 174470.3107988972, "
            "172729.36494001048 174470.20779888984, "
            "172733.29694 174468.74879888006, "
            "172732.51594000997 174463.94179888, "
            "172736.18094000997 174462.86079888, "
            "172736.12094 174460.75779888, "
            "172739.38593999937 174460.04779889015, "
            "172751.74194 174457.62979889003, "
            "172751.82374942137 174457.8052091417, "
            "172760.30108298364 174475.9976912029, "
            "172767.25628262636 174472.6322513803, "
            "172767.5851149932 174472.47314720228, "
            "172767.50690699372 174472.13401120156, "
            "172767.1188087445 174472.3620791199, "
            "172766.30993999983 174470.7767988602, "
            "172765.64794001004 174469.48679887998, "
            "172766.51694001004 174469.12679887997, "
            "172765.12794 174466.03679888998, "
            "172764.34694001 174466.34679888003, "
            "172762.84694005293 174463.15679897126, "
            "172763.29320167168 174462.94189765144, "
            "172764.2839314731 174462.46480300103, "
            "172765.32593999998 174461.96179887993, "
            "172761.1385378274 174453.29491927216, "
            "172761.13853782744 174453.29491927216, "
            "172760.09694000988 174451.01679888976, "
            "172759.79494001003 174450.12279889, "
            "172760.93594000998 174449.76179888003, "
            "172761.82593999995 174450.27579889004, "
            "172762.67400122888 174449.91177263303, "
            "172765.15694 174448.84679888003, "
            "172764.19994000997 174445.99879888, "
            "172764.60994001062 174445.80279888492, "
            "172764.33894001 174444.31479887993, "
            "172763.51689098784 174441.74149918192, "
            "172763.5168882326 174441.74150007046, "
            "172763.51688823258 174441.74150007026, "
            "172763.21993999998 174440.02779889002, "
            "172761.17694 174440.68879888, "
            "172759.74790522835 174436.7047019099, "
            "172755.11890209024 174438.21366147915, "
            "172754.95691696025 174437.6267152474, "
            "172754.85751089564 174437.26601325686, "
            "172754.6069400003 174436.3567988909, "
            "172755.10336595034 174436.22560282986, "
            "172756.19993908802 174435.93579913364, "
            "172758.35593845724 174435.36579929787, "
            "172760.84694000997 174434.70679888004, "
            "172760.58894161868 174433.5358061814, "
            "172760.14693999995 174431.53679888978, "
            "172759.5329400001 174429.6077988801, "
            "172759.52534339868 174429.53306474834, "
            "172759.48582006822 174429.1442406328, "
            "172759.76815493542 174429.05234718855, "
            "172759.7528128644 174429.0162936086, "
            "172759.12745483534 174427.54860076858, "
            "172759.12745462733 174427.54860004058, "
            "172759.1267469823 174427.54693917185, "
            "172759.12695293076 174427.54684410253, "
            "172758.76693612643 174426.28678529424, "
            "172758.12194001 174424.02879888, "
            "172758.32293999995 174423.95879888002, "
            "172758.05193999998 174421.82179889004, "
            "172756.6439400104 174422.12379887994, "
            "172756.53950232168 174422.15535105282, "
            "172755.98194000003 174422.32379888996, "
            "172755.12451175836 174419.47773878835, "
            "172753.83321806323 174419.78523359896, "
            "172752.4939518636 174414.58684488994, "
            "172751.20706697553 174414.83333916217, "
            "172750.73129098117 174412.7877071612, "
            "172748.95247497407 174413.2481231615, "
            "172748.47247497732 174411.39813916016, "
            "172753.23247498277 174410.11813915893, "
            "172751.57647497955 174404.02937115356, "
            "172750.80501897636 174401.19289115068, "
            "172749.21920579113 174395.36230315745, "
            "172749.2194832201 174395.36220860117, "
            "172749.08793999997 174394.87879889001, "
            "172750.24394001003 174394.48479888003, "
            "172751.79493705663 174393.68580041145, "
            "172753.32194001004 174392.89979888, "
            "172754.02694001 174394.06179887996, "
            "172759.86194000999 174390.84279887998, "
            "172760.84694001003 174392.75779887996, "
            "172762.75293454644 174391.80780159816, "
            "172762.7540957816 174391.80722369105, "
            "172764.6779369368 174390.84980040943, "
            "172767.0349380484 174389.675799857, "
            "172769.10393896094 174388.64579940226, "
            "172770.8269400001 174387.78779888, "
            "172772.41231297184 174387.0021096416, "
            "172769.92245898946 174381.99321113512, "
            "172769.86473163788 174381.87794843127, "
            "172766.27740298968 174374.71225113448, "
            "172766.12751504182 174374.37625125528, "
            "172765.45154720507 174372.86111561494, "
            "172764.5623949914 174370.86834713045, "
            "172758.44661898166 174358.71346712485, "
            "172758.08089647835 174357.9866221479, "
            "172758.0812897689 174357.9865175769, "
            "172757.8519399999 174357.5307988898, "
            "172754.4110373197 174349.3873883099, "
            "172754.41083817216 174349.3874620819, "
            "172754.04609390008 174348.52429801252, "
            "172753.7164504677 174347.74419976756, "
            "172753.71289365587 174347.7351269625, "
            "172752.91599497944 174345.84914711493, "
            "172752.96828298277 174345.83532311398, "
            "172752.74697099614 174345.2712271516, "
            "172750.88521097507 174340.5253711095, "
            "172749.90261897308 174337.94073110458, "
            "172742.68309897187 174319.57548309487, "
            "172729.2444429621 174323.76869909838, "
            "172729.1040909663 174323.3482191004, "
            "172719.76546695834 174325.91705109927, "
            "172721.48245895657 174332.9833551049, "
            "172723.08294328308 174339.57013976108, "
            "172723.03791828503 174339.58436050604, "
            "172723.15793999998 174340.07079887998, "
            "172719.07994 174341.35879888994, "
            "172719.0331842302 174340.8492201192, "
            "172718.5874979483 174340.98998616525, "
            "172718.5534989536 174340.6227151118, "
            "172714.9709069505 174341.62623511252, "
            "172702.72073094547 174345.05746711424, "
            "172703.20898694542 174346.73209111392, "
            "172703.9096589461 174349.13503511623, "
            "172695.26953093708 174351.39500311756, "
            "172694.93771905327 174349.74538306356, "
            "172692.57990415473 174350.34580801197, "
            "172692.57334559556 174350.34747709305, "
            "172689.68390132912 174351.0828087242, "
            "172689.6768192437 174351.08460978328, "
            "172686.95894150986 174351.77579850602, "
            "172684.89594078047 174352.3007986814, "
            "172684.8828689878 174352.30412604674, "
            "172683.3009262921 174352.70680236846, "
            "172681.18281584515 174353.24583040207, "
            "172679.3319479569 174353.71579686215, "
            "172677.40094000465 174354.20779888882, "
            "172677.27266865686 174353.73419735025, "
            "172676.77394073328 174351.89280155062, "
            "172676.06193873903 174349.26679423897, "
            "172675.7409324217 174348.08277088706, "
            "172675.25994054292 174346.30780088357, "
            "172675.2596599193 174346.30676614863, "
            "172674.46692653303 174343.38374918967, "
            "172673.58194064876 174340.11780124725, "
            "172672.77094000002 174337.12779888004, "
            "172670.9499049531 174337.60880813404, "
            "172670.52563620973 174337.72080595847, "
            "172669.09919766168 174338.09735505903, "
            "172669.08994002102 174338.09979887708, "
            "172668.25594001057 174338.3197988899, "
            "172663.54094 174339.43779888, "
            "172663.9509396747 174340.9917976469, "
            "172663.95246609734 174340.9975798821, "
            "172664.37093995474 174342.5827987186, "
            "172664.9449393093 174344.75679626403, "
            "172665.47293987044 174346.75879839866, "
            "172665.473080069 174346.7593299183, "
            "172666.08593904617 174349.08279523588, "
            "172666.0860074876 174349.08305431984, "
            "172666.77093856825 174351.67579347026, "
            "172667.44093999997 174354.21779888, "
            "172665.21794001 174354.76179888, "
            "172665.0101183685 174354.8126524625, "
            "172663.37894000002 174355.21179888002, "
            "172663.37873282918 174355.21184957805, "
            "172661.5809427116 174355.65179822646, "
            "172659.15894248072 174356.2437982761, "
            "172656.24094000997 174356.95779889004, "
            "172655.8289405051 174354.98780124754, "
            "172655.30694000996 174352.49479888997, "
            "172654.75393999997 174349.85379887992, "
            "172653.44093999994 174347.26779887994, "
            "172650.79094000012 174346.37779887998, "
            "172649.39294039877 174346.74579877505, "
            "172649.3911846923 174346.7462610297, "
            "172648.1699417751 174347.06779842527, "
            "172643.14494001 174348.38979889, "
            "172642.93389291374 174348.44532466854, "
            "172640.56794000996 174349.06779889, "
            "172640.41789637046 174349.10727144754, "
            "172638.06294 174349.72679888003, "
            "172635.8089427633 174350.319798163, "
            "172634.01694338908 174350.79179799, "
            "172631.56094000998 174351.43779888997, "
            "172631.68094001 174351.69779888, "
            "172630.46894738195 174352.0517967368, "
            "172630.4687520214 174352.05185395735, "
            "172629.2809437475 174352.39979778518, "
            "172627.68094000997 174352.86779889, "
            "172628.10093847304 174354.1197943085, "
            "172628.10107294662 174354.1201945294, "
            "172628.6879379874 174355.86679290008, "
            "172628.68799114702 174355.86695143604, "
            "172629.43093933648 174358.08279688127, "
            "172629.43133035954 174358.0839622848, "
            "172630.24693959064 174360.5147976402, "
            "172630.24792235918 174360.51772822303, "
            "172630.85693939638 174362.3337970801, "
            "172631.76094 174365.02779888996, "
            "172632.43094001003 174364.86779888996, "
            "172632.93494001002 174366.67479888993, "
            "172630.87694000924 174367.2867988902, "
            "172629.35094510994 174367.69579751312, "
            "172629.35049890392 174367.69591735688, "
            "172627.54894514213 174368.17979751158, "
            "172627.52128803954 174368.18721035263, "
            "172625.4409402792 174368.7447988152, "
            "172625.43971959242 174368.74512604062, "
            "172623.82194391786 174369.17879783243, "
            "172621.82194405483 174369.715797794, "
            "172621.82183787943 174369.71582625585, "
            "172620.13194178292 174370.16879840213, "
            "172618.52894290345 174370.59879811114, "
            "172616.85694000009 174371.04679887995, "
            "172613.67694 174372.43679888, "
            "172612.2709414281 174372.87179843814, "
            "172610.70894325845 174373.35479788246, "
            "172608.85694 174373.92679889, "
            "172608.25794049533 174371.89080052968, "
            "172607.82694000003 174370.42679889002, "
            "172607.51030628625 174370.515852122, "
            "172607.38694001004 174370.06679887997, "
            "172607.01194001 174368.70179888996, "
            "172605.61394000004 174369.12679888998, "
            "172604.29194001 174364.49979887996, "
            "172605.79494001003 174364.27579888995, "
            "172604.95794001003 174361.23079889003, "
            "172604.15693999996 174358.31679887997, "
            "172601.3829428521 174359.08279810517, "
            "172600.24729543962 174359.3960325686, "
            "172597.84457264078 174350.6279695617, "
            "172597.51694001004 174350.71679888997, "
            "172593.94294000993 174351.68579889, "
            "172594.4599387648 174353.5957943269, "
            "172594.89194001 174355.18879888, "
            "172594.43694 174355.28679888998, "
            "172595.10393895835 174357.58879525043, "
            "172595.61693890326 174359.35679511022, "
            "172596.36993943545 174361.95579694142, "
            "172596.92693999998 174363.87679887997, "
            "172594.25694 174364.45679887995, "
            "172594.21693999998 174364.31679888006, "
            "172593.00494592657 174364.6537972349, "
            "172593.00452690053 174364.65391402238, "
            "172592.00394302807 174364.932798036, "
            "172590.26894162453 174365.41579843775, "
            "172588.36994388918 174365.94479780665, "
            "172588.36984125132 174365.94482635465, "
            "172586.29894001002 174366.52079888002, "
            "172585.7109407086 174364.2888015419, "
            "172585.71082483808 174364.2883622034, "
            "172585.01994076036 174361.66880173524, "
            "172584.8667329185 174361.0872324162, "
            "172584.37794 174359.23179888996, "
            "172583.4569404406 174355.73580051467, "
            "172582.56193999999 174352.34079887997, "
            "172581.81194 174349.49579887997, "
            "172578.96056568567 174350.36739802494, "
            "172585.1382444169 174374.19050227254, "
            "172585.0614705477 174374.21335843968, "
            "172585.18994 174374.69679888996, "
            "172581.69994000997 174375.73579888, "
            "172581.62350512363 174375.3929519558, "
            "172581.93994000004 174374.65479888, "
            "172582.48094 174373.39279888003, "
            "172580.61794 174366.54279888, "
            "172576.77667659082 174367.3948403584, "
            "172578.3008907684 174373.35775476237, "
            "172578.52405885607 174374.23071513322, "
            "172580.47195049844 174381.85118837637, "
            "172580.4625612569 174381.85333750857, "
            "172580.58694000004 174382.33779888, "
            "172578.45494 174382.82579888, "
            "172576.95294001 174376.09679888003, "
            "172576.23194 174376.15679888002, "
            "172575.20993999997 174372.55179889, "
            "172573.66458694366 174372.8308626458, "
            "172574.0934668556 174374.3819471337, "
            "172574.33365876754 174375.25074680167, "
            "172574.7994377378 174376.93505831185, "
            "172574.46694027368 174377.10679874866, "
            "172573.55473542705 174377.38586125555, "
            "172571.95794220705 174377.87279822002, "
            "172569.12694000997 174378.73679888004, "
            "172570.29693999997 174382.59679888, "
            "172569.06894000657 174382.95779888806, "
            "172568.98899089158 174382.9810527852, "
            "172567.62494267538 174383.37779810186, "
            "172566.1759413303 174383.7987985035, "
            "172564.9709467131 174384.14879693012, "
            "172563.53494001646 174384.5647988781, "
            "172562.23594001002 174384.94279888997, "
            "172561.03905731053 174385.28960586703, "
            "172554.56188284606 174386.74853914225, "
            "172555.21404284242 174388.99244314435, "
            "172557.3838523062 174396.45835165278)),"
            "((172739.38594000007 174460.04779889, "
            "172739.39373637483 174460.04610350684, "
            "172739.392673916 174460.04121769255, "
            "172739.3870486459 174460.03837656736, "
            "172739.38261013498 174460.0403655549, "
            "172739.3807950899 174460.03631378766, "
            "172739.37623201194 174460.03835788142, "
            "172739.37262919155 174460.04530889943, "
            "172739.37358944913 174460.05021582366, "
            "172739.3858038434 174460.04782553512, "
            "172739.3859399994 174460.04779889015, "
            "172739.38594000007 174460.04779889)))"
        )
        result = safe_intersection(polygon_a, polygon_b)  # GEOS exception is caught
        self.assertTrue(result.is_valid)

    def test_safe_difference(self):
        """Tests safe_difference with a polygon contained within another."""
        polygon_a = Polygon([(0, 0), (1, 0), (1, 1), (0, 1)])
        polygon_b = Polygon([(0.2, 0.2), (0.8, 0.2), (0.8, 0.8), (0.2, 0.8)])
        result = safe_difference(polygon_a, polygon_b)
        self.assertTrue(result.is_valid)

    def test_safe_difference_geos_exception(self):
        """Tests safe_difference with a geos exception."""

        polygon_a = from_wkt(
            "MULTIPOLYGON(((172767.25694 174472.63279888, "
            "172766.30994001 174470.77679888, "
            "172765.64794001 174469.48679888, "
            "172766.51694001 174469.12679888, "
            "172765.12794 174466.03679889, "
            "172764.34694001 174466.34679888, "
            "172762.84694001 174463.15679888, "
            "172764.28394001 174462.46479889, "
            "172765.32594 174461.96179888, "
            "172761.13894 174453.29579888, "
            "172760.09694001 174451.01679889, "
            "172759.79494001 174450.12279889, "
            "172760.93594001 174449.76179888, "
            "172761.82594 174450.27579889, "
            "172762.67394001 174449.91179889, "
            "172765.15694 174448.84679888, "
            "172764.19994001 174445.99879888, "
            "172764.60994 174445.80279889, "
            "172764.33894001 174444.31479888, "
            "172763.51694001 174441.74179888, "
            "172763.21994 174440.02779889, "
            "172761.17694 174440.68879888, "
            "172759.74794001 174436.70479888, "
            "172759.02694001 174436.93979888, "
            "172756.96694 174437.61179889, "
            "172755.11894001 174438.21379888, "
            "172754.95694001 174437.62679889, "
            "172754.60694 174436.35679889, "
            "172756.19994001 174435.93579889, "
            "172758.35594 174435.36579889, "
            "172760.84694001 174434.70679888, "
            "172760.58894001 174433.53579888, "
            "172760.14694 174431.53679889, "
            "172759.53294 174429.60779888, "
            "172759.38494 174428.15179888, "
            "172759.12694001 174427.54679888, "
            "172758.76694001 174426.28679889, "
            "172758.12194001 174424.02879888, "
            "172758.32294 174423.95879888, "
            "172758.05194 174421.82179889, "
            "172756.64394001 174422.12379888, "
            "172755.98194 174422.32379889, "
            "172755.12694001 174419.48579888, "
            "172753.83594001 174419.79579889, "
            "172752.49394001 174414.58679888, "
            "172751.20794001 174414.83379888, "
            "172750.65294001 174412.80779888, "
            "172748.95294001 174413.24779889, "
            "172748.47294 174411.39879889, "
            "172753.23294001 174410.11879888, "
            "172752.77094 174408.42079889, "
            "172752.20594 174406.34079888, "
            "172751.57694 174404.02979888, "
            "172750.94994001 174401.72379889, "
            "172750.44494 174399.86779889, "
            "172749.65394 174396.95879888, "
            "172749.08794 174394.87879889, "
            "172750.24394001 174394.48479888, "
            "172751.79494001 174393.68579889, "
            "172753.32194001 174392.89979888, "
            "172754.02694001 174394.06179888, "
            "172759.86194001 174390.84279888, "
            "172760.84694001 174392.75779888, "
            "172762.75294 174391.80779888, "
            "172764.67794001 174390.84979888, "
            "172767.03494001 174389.67579888, "
            "172769.10394001 174388.64579888, "
            "172770.82694 174387.78779888, "
            "172772.41294001 174387.00179889, "
            "172771.70694001 174385.58179888, "
            "172770.47494001 174383.10379888, "
            "172769.86494001 174381.87779888, "
            "172769.31094001 174380.77179889, "
            "172768.51694001 174379.18579889, "
            "172767.43494001 174377.02279888, "
            "172766.27794001 174374.71279889, "
            "172765.78994 174373.61879888, "
            "172765.24294 174372.39279888, "
            "172764.56294 174370.86879888, "
            "172763.48394 174368.72379889, "
            "172762.58994001 174366.94779889, "
            "172761.36994 174364.52279888, "
            "172760.27094 174362.33879888, "
            "172759.15994001 174360.12979888, "
            "172757.85194 174357.53079889, "
            "172752.91594 174345.84979888, "
            "172752.44494 174344.50079888, "
            "172751.68294 174342.55779888, "
            "172750.88594 174340.52579889, "
            "172749.87694001 174337.94779888, "
            "172748.82694 174335.20279888, "
            "172747.72094 174332.38879888, "
            "172746.51294001 174329.31579889, "
            "172745.36494001 174326.39779888, "
            "172743.82194001 174322.47179888, "
            "172742.68394 174319.57579888, "
            "172739.86294 174320.46079888, "
            "172737.67194 174320.96779888, "
            "172736.12194001 174321.39879889, "
            "172733.90294001 174322.01479889, "
            "172731.21594 174322.76179888, "
            "172729.70094 174323.15779889, "
            "172729.10494001 174323.34879888, "
            "172727.50294 174323.86079888, "
            "172724.60494001 174324.78679888, "
            "172719.82894001 174326.31279889, "
            "172720.17794001 174327.77779889, "
            "172720.41094 174328.75779888, "
            "172720.82494001 174330.49979889, "
            "172721.08494 174331.56079889, "
            "172721.42594 174332.98579888, "
            "172721.70594 174334.18179888, "
            "172722.03394001 174335.51479889, "
            "172722.60994 174337.84979888, "
            "172723.15794 174340.07079888, "
            "172719.07994 174341.35879889, "
            "172719.00094001 174340.49779889, "
            "172718.62994001 174340.60179888, "
            "172717.50294 174340.91679888, "
            "172714.97094 174341.62679888, "
            "172714.17294 174341.84979888, "
            "172712.47094 174342.32679888, "
            "172710.41394001 174342.90279889, "
            "172708.33894001 174343.48379889, "
            "172705.43894001 174344.29679888, "
            "172702.72094 174345.05779888, "
            "172703.36294 174347.25779888, "
            "172703.90994001 174349.13479888, "
            "172702.14294 174349.59779889, "
            "172700.29694 174350.08079888, "
            "172697.39194001 174350.83979889, "
            "172695.26994001 174351.39479888, "
            "172694.94394 174349.74379888, "
            "172692.57994 174350.34579889, "
            "172689.68394 174351.08279889, "
            "172686.95894 174351.77579889, "
            "172684.89594 174352.30079888, "
            "172683.30094 174352.70679888, "
            "172681.18294 174353.24579888, "
            "172679.33194001 174353.71579888, "
            "172677.40094 174354.20779889, "
            "172676.77394001 174351.89279888, "
            "172676.06194 174349.26679889, "
            "172675.74094001 174348.08279889, "
            "172675.25994 174346.30779888, "
            "172674.46694 174343.38379889, "
            "172673.58194001 174340.11779889, "
            "172672.77094 174337.12779888, "
            "172670.94994001 174337.60879888, "
            "172669.08994001 174338.09979888, "
            "172668.25594001 174338.31979889, "
            "172663.54094 174339.43779888, "
            "172663.95094 174340.99179888, "
            "172664.37094 174342.58279889, "
            "172664.94494 174344.75679888, "
            "172665.47294 174346.75879889, "
            "172666.08594001 174349.08279889, "
            "172666.77094 174351.67579889, "
            "172667.44094 174354.21779888, "
            "172665.21794001 174354.76179888, "
            "172663.37894 174355.21179888, "
            "172661.58094 174355.65179889, "
            "172659.15894001 174356.24379888, "
            "172656.24094001 174356.95779889, "
            "172655.82894001 174354.98779888, "
            "172655.30694001 174352.49479889, "
            "172654.75394 174349.85379888, "
            "172653.44094 174347.26779888, "
            "172650.79094 174346.37779888, "
            "172649.39294 174346.74579888, "
            "172648.16994001 174347.06779889, "
            "172643.14494001 174348.38979889, "
            "172640.56794001 174349.06779889, "
            "172638.06294 174349.72679888, "
            "172635.80894 174350.31979889, "
            "172634.01694001 174350.79179888, "
            "172631.56094001 174351.43779889, "
            "172631.68094001 174351.69779888, "
            "172630.46894001 174352.05179889, "
            "172629.28094001 174352.39979888, "
            "172627.68094001 174352.86779889, "
            "172628.10094001 174354.11979889, "
            "172628.68794 174355.86679889, "
            "172629.43094001 174358.08279889, "
            "172630.24694001 174360.51479889, "
            "172630.85694 174362.33379888, "
            "172631.76094 174365.02779889, "
            "172632.43094001 174364.86779889, "
            "172632.93494001 174366.67479889, "
            "172630.87694001 174367.28679889, "
            "172629.35094001 174367.69579888, "
            "172627.54894001 174368.17979889, "
            "172625.44094 174368.74479889, "
            "172623.82194001 174369.17879888, "
            "172621.82194001 174369.71579888, "
            "172620.13194 174370.16879888, "
            "172618.52894 174370.59879889, "
            "172616.85694 174371.04679888, "
            "172613.67694 174372.43679888, "
            "172612.27094 174372.87179888, "
            "172610.70894 174373.35479889, "
            "172608.85694 174373.92679889, "
            "172608.25794001 174371.89079888, "
            "172607.82694 174370.42679889, "
            "172607.50694 174370.51679889, "
            "172607.38694001 174370.06679888, "
            "172607.01194001 174368.70179889, "
            "172605.61394 174369.12679889, "
            "172604.29194001 174364.49979888, "
            "172605.79494001 174364.27579889, "
            "172604.95794001 174361.23079889, "
            "172604.15694 174358.31679888, "
            "172601.38294001 174359.08279889, "
            "172599.73694001 174359.53679889, "
            "172599.03094001 174356.96479888, "
            "172598.45694001 174354.87679889, "
            "172598.31094001 174353.65579888, "
            "172597.92494001 174352.22579889, "
            "172597.51694001 174350.71679889, "
            "172593.94294001 174351.68579889, "
            "172594.45994 174353.59579889, "
            "172594.89194001 174355.18879888, "
            "172594.43694 174355.28679889, "
            "172595.10394001 174357.58879888, "
            "172595.61694 174359.35679889, "
            "172596.36994 174361.95579889, "
            "172596.92694 174363.87679888, "
            "172594.25694 174364.45679888, "
            "172594.21694 174364.31679888, "
            "172593.00494001 174364.65379888, "
            "172592.00394 174364.93279888, "
            "172590.26894 174365.41579889, "
            "172588.36994 174365.94479889, "
            "172586.29894001 174366.52079888, "
            "172585.71094001 174364.28879889, "
            "172585.01994001 174361.66879889, "
            "172584.37794 174359.23179889, "
            "172583.45694001 174355.73579888, "
            "172582.56194 174352.34079888, "
            "172581.81194 174349.49579888, "
            "172578.83494 174350.40579889, "
            "172579.40794 174352.63579888, "
            "172579.78994 174354.11679888, "
            "172580.28794001 174356.05279889, "
            "172580.77094 174357.92779888, "
            "172581.47694 174360.66679888, "
            "172581.97094 174362.58679888, "
            "172582.24294 174363.61779889, "
            "172582.54194001 174364.74379888, "
            "172582.91294001 174366.13879888, "
            "172583.24094001 174367.37179888, "
            "172583.56894 174368.60379888, "
            "172583.98394 174370.16379889, "
            "172584.46094001 174371.95479888, "
            "172584.86494001 174373.47379888, "
            "172585.18994 174374.69679889, "
            "172581.69994001 174375.73579888, "
            "172581.45894 174374.65479888, "
            "172581.93994 174374.65479888, "
            "172582.48094 174373.39279888, "
            "172580.61794 174366.54279888, "
            "172576.54694 174367.44579888, "
            "172576.96094001 174368.82979888, "
            "172577.49594 174370.61579889, "
            "172578.20294001 174372.70579888, "
            "172578.57394 174374.21879889, "
            "172578.69794 174374.72879888, "
            "172578.94194001 174375.71979888, "
            "172579.21594 174376.83779888, "
            "172579.48694001 174377.94179888, "
            "172579.78194 174379.14479889, "
            "172580.08194001 174380.37079888, "
            "172580.58694 174382.33779888, "
            "172578.45494 174382.82579888, "
            "172576.95294001 174376.09679888, "
            "172576.23194 174376.15679888, "
            "172575.20994 174372.55179889, "
            "172573.66494 174372.83079889, "
            "172574.33394 174375.25079888, "
            "172574.79994001 174376.93479888, "
            "172574.46694 174377.10679889, "
            "172573.55494 174377.38579888, "
            "172571.95794001 174377.87279889, "
            "172569.12694001 174378.73679888, "
            "172570.29694 174382.59679888, "
            "172569.06894 174382.95779889, "
            "172567.62494 174383.37779888, "
            "172566.17594 174383.79879889, "
            "172564.97094 174384.14879888, "
            "172563.53494001 174384.56479888, "
            "172562.23594001 174384.94279889, "
            "172561.03494001 174385.29079889, "
            "172559.35194 174385.66979888, "
            "172558.39794001 174385.88479888, "
            "172556.63694001 174386.28179888, "
            "172554.56194 174386.74879888, "
            "172554.93394 174388.02679888, "
            "172555.33194001 174389.39779888, "
            "172555.78394001 174390.95079888, "
            "172556.25094001 174392.55979888, "
            "172556.78094001 174394.38279888, "
            "172557.38394001 174396.45779889, "
            "172555.12994001 174410.66979888, "
            "172554.04194001 174412.21079889, "
            "172554.18094001 174413.74279889, "
            "172554.35894 174415.69279889, "
            "172554.59094 174418.23979888, "
            "172554.80294001 174420.57479888, "
            "172555.02794001 174423.04279888, "
            "172555.93294 174422.97279889, "
            "172557.54494001 174422.84879889, "
            "172560.00094001 174422.89679889, "
            "172562.04294 174422.83779889, "
            "172563.99094001 174422.77979888, "
            "172565.29094 174422.74079889, "
            "172567.21594 174422.68179889, "
            "172569.10194 174422.62379888, "
            "172568.98294001 174421.27879888, "
            "172568.88094001 174420.13579889, "
            "172568.73194 174418.45579889, "
            "172568.45294001 174415.31879888, "
            "172570.64394 174415.21279889, "
            "172570.64394001 174420.55979889, "
            "172572.08594001 174420.43979888, "
            "172572.08594001 174421.46179888, "
            "172572.89894001 174421.52179889, "
            "172572.93594001 174418.69679889, "
            "172572.92794001 174415.53279888, "
            "172575.20994 174415.51279889, "
            "172575.27294001 174421.23079888, "
            "172577.66994001 174421.37079888, "
            "172577.71794001 174420.68179889, "
            "172577.72494001 174418.93679889, "
            "172577.73594001 174415.93279888, "
            "172580.01694001 174415.87379888, "
            "172579.83694 174420.49979889, "
            "172581.27894 174420.49979889, "
            "172581.16094 174421.60179888, "
            "172582.17694 174421.66979888, "
            "172582.13594 174422.43279888, "
            "172582.06294 174423.81779889, "
            "172581.85494001 174425.10579888, "
            "172581.54394 174425.96979888, "
            "172582.27094 174425.90879888, "
            "172583.34994001 174425.81679888, "
            "172584.44594001 174425.72479888, "
            "172585.57394 174425.43879889, "
            "172587.27294001 174425.00679888, "
            "172589.82794001 174424.35879889, "
            "172589.40294001 174423.53179888, "
            "172589.03494001 174422.06079888, "
            "172588.59694001 174420.30879889, "
            "172588.35594 174419.34679888, "
            "172587.97694 174417.82879889, "
            "172587.78294 174417.05679889, "
            "172587.61594001 174415.77979888, "
            "172587.36494001 174414.35979888, "
            "172587.75394 174413.42079888, "
            "172587.86994 174411.44879889, "
            "172592.26794 174410.32279888, "
            "172592.57794001 174412.11779889, "
            "172593.54694 174411.85679889, "
            "172593.88294001 174413.17479889, "
            "172596.71694 174412.45279888, "
            "172597.50594001 174415.42779888, "
            "172593.94094 174416.36279888, "
            "172594.31794001 174417.67579888, "
            "172595.57994 174417.37579888, "
            "172595.88594 174418.96979888, "
            "172599.56994 174418.29279888, "
            "172600.39494001 174421.68079888, "
            "172599.12494 174422.00279888, "
            "172597.83994001 174422.32779888, "
            "172595.25594001 174422.98279888, "
            "172595.67794001 174424.90679888, "
            "172598.81094001 174424.21879889, "
            "172599.32294 174426.26379888, "
            "172599.83994001 174428.32779888, "
            "172600.28294 174430.09379889, "
            "172599.53294 174430.30379888, "
            "172598.94794 174431.12079888, "
            "172598.50794001 174431.73679888, "
            "172598.17194 174432.53079888, "
            "172597.70394001 174433.63779889, "
            "172598.26694001 174435.35479889, "
            "172601.68394 174434.46579888, "
            "172602.63794001 174437.85679889, "
            "172603.52094 174441.33179888, "
            "172604.18794 174443.95879889, "
            "172607.05394 174443.20479888, "
            "172608.01694001 174447.05779888, "
            "172602.61494001 174448.18279888, "
            "172603.57694 174451.96779888, "
            "172591.37294001 174454.98979888, "
            "172593.09694001 174460.86279888, "
            "172596.00694 174460.12279889, "
            "172599.45294001 174459.24579888, "
            "172605.06394001 174457.81879888, "
            "172608.39694 174456.97079889, "
            "172613.56094001 174455.65679888, "
            "172614.32594 174458.77479888, "
            "172609.11894001 174459.86879888, "
            "172606.47194001 174460.59979888, "
            "172604.45794001 174461.15679888, "
            "172605.34094 174464.77179889, "
            "172607.57394 174464.20979889, "
            "172609.99094001 174463.60579889, "
            "172613.07994 174462.83479889, "
            "172613.61894001 174464.88379889, "
            "172614.04994001 174466.51979889, "
            "172614.37794 174467.76679889, "
            "172612.53894001 174468.36579889, "
            "172611.16394001 174468.81479888, "
            "172608.52994 174469.67379888, "
            "172609.11194001 174471.76679889, "
            "172609.56494 174473.39879889, "
            "172612.91294001 174485.56179888, "
            "172614.59894 174485.11079888, "
            "172617.38894 174484.36379889, "
            "172622.33194001 174483.04179888, "
            "172625.99594 174482.06079889, "
            "172629.84294001 174481.03179888, "
            "172641.95194 174477.65279889, "
            "172643.75494001 174477.16979888, "
            "172645.38894 174476.73279888, "
            "172647.53094001 174476.15979889, "
            "172649.87894 174475.53179888, "
            "172652.14894001 174474.92479889, "
            "172655.08794 174474.13879889, "
            "172656.82294 174473.67479889, "
            "172659.20494 174473.03779889, "
            "172661.12994001 174472.52279888, "
            "172663.13094001 174471.98779888, "
            "172666.07294 174471.20079888, "
            "172669.09894 174470.39179889, "
            "172670.32794001 174470.07579888, "
            "172672.24694001 174469.58179889, "
            "172673.91894 174469.15179888, "
            "172674.58694 174468.84879889, "
            "172675.52994 174468.59879889, "
            "172677.88094001 174467.97779889, "
            "172680.51794 174467.28079889, "
            "172683.39194001 174466.52079888, "
            "172686.88994 174465.59579889, "
            "172690.08694 174464.75079888, "
            "172693.60394001 174463.82179889, "
            "172694.71594 174465.90079889, "
            "172695.81494 174467.95779889, "
            "172696.76694001 174469.73679889, "
            "172698.74294 174473.43379889, "
            "172700.00894001 174475.80279888, "
            "172701.21194 174478.05279888, "
            "172702.29394 174480.07679889, "
            "172712.67294 174477.65879888, "
            "172714.31294 174477.23479888, "
            "172715.92294 174476.81879889, "
            "172718.15094 174476.24279889, "
            "172719.85594 174475.80279888, "
            "172719.07394 174472.68079888, "
            "172722.78994 174471.85879889, "
            "172723.62094 174471.64979888, "
            "172726.34994001 174470.96079888, "
            "172727.68494001 174470.62379888, "
            "172728.34494 174470.45779889, "
            "172728.94594001 174470.31079889, "
            "172729.36494001 174470.20779889, "
            "172733.29694 174468.74879888, "
            "172732.51594001 174463.94179888, "
            "172736.18094001 174462.86079888, "
            "172736.12094 174460.75779888, "
            "172739.38594 174460.04779889, "
            "172751.74194 174457.62979889, "
            "172752.52594 174459.31079889, "
            "172753.47194001 174461.34079888, "
            "172754.32394 174463.17079889, "
            "172755.22994001 174465.11479888, "
            "172756.45494 174467.74379888, "
            "172757.91194 174470.86979889, "
            "172759.17194 174473.57379889, "
            "172760.30194 174475.99779889, "
            "172767.25694 174472.63279888)))"
        )
        polygon_b = from_wkt(
            "MULTIPOLYGON(((172557.3838523062 174396.45835165278, "
            "172555.12905084348 174410.6693711578, "
            "172554.04105084387 174412.2103631608, "
            "172554.28937084228 174414.93676316369, "
            "172555.0277388468 174423.0425551683, "
            "172563.7369228527 174422.37100316587, "
            "172569.0432908535 174421.9618511684, "
            "172568.4963957805 174415.81728130922, "
            "172568.4972705121 174415.81723898993, "
            "172568.45294000994 174415.31879887995, "
            "172570.64394 174415.21279888996, "
            "172570.64394001 174420.55979889, "
            "172572.08594000997 174420.43979888, "
            "172572.08594000997 174420.94152719184, "
            "172572.77495595193 174420.8841888285, "
            "172572.71193637606 174416.03471118974, "
            "172572.929204253 174416.03280700246, "
            "172572.92794000998 174415.53279887998, "
            "172575.20994000003 174415.51279889, "
            "172575.27294001004 174421.23079888, "
            "172577.6697196799 174421.37078601134, "
            "172577.70199362023 174416.43384416474, "
            "172577.73410833202 174416.4330134905, "
            "172577.7358131635 174415.9674395041, "
            "172577.73594001 174415.93279888004, "
            "172578.87644000998 174415.90329888, "
            "172580.01694000998 174415.87379888, "
            "172579.83694 174420.49979889003, "
            "172581.27894 174420.49979889003, "
            "172581.22540097954 174420.99979889003, "
            "172582.22334147422 174420.99979889003, "
            "172582.17621886 174421.66917916582, "
            "172582.0176908598 174424.652603168, "
            "172581.5430028588 174425.96959516776, "
            "172581.36988285926 174426.44985117015, "
            "172583.22229886055 174426.393211171, "
            "172584.53372231862 174426.04524331444, "
            "172585.60137086362 174425.76191516966, "
            "172589.6888588667 174424.67730716988, "
            "172588.59657086435 174420.30905116722, "
            "172587.97628287587 174417.82828320874, "
            "172587.62773886323 174416.44255516306, "
            "172587.57641086724 174416.43890716136, "
            "172587.6150668636 174415.78034716102, "
            "172587.75349886715 174413.420987159, "
            "172587.86921086907 174411.4484431595, "
            "172591.77150026744 174410.4497097941, "
            "172592.26794067942 174410.3228028141, "
            "172592.57794001006 174412.11779889002, "
            "172593.54694000003 174411.85679889002, "
            "172593.88294001002 174413.17479889, "
            "172596.71693999998 174412.45279888005, "
            "172597.50594000999 174415.42779887991, "
            "172597.172895412 174415.51514718245, "
            "172597.022295644 174415.5546452982, "
            "172597.0224054087 174415.55505917643, "
            "172593.93199883454 174416.33165895962, "
            "172593.94094 174416.36279887997, "
            "172594.31794001002 174417.67579888002, "
            "172595.57994 174417.37579888004, "
            "172595.88594000004 174418.96979887996, "
            "172599.56993999996 174418.29279888, "
            "172600.39494000998 174421.68079888003, "
            "172599.91025387176 174421.80368780546, "
            "172599.94715650496 174421.95523461731, "
            "172596.69628287107 174422.8178511672, "
            "172595.3009759594 174423.18812865848, "
            "172595.67794001 174424.90679888, "
            "172598.81094000905 174424.2187988902, "
            "172598.92996166085 174424.6941881079, "
            "172599.32293973575 174426.26379782447, "
            "172599.32319430308 174426.26481412462, "
            "172599.83993917855 174428.32779556068, "
            "172600.28294000003 174430.09379889, "
            "172599.53294 174430.30379888, "
            "172598.9479399949 174431.12079888713, "
            "172598.50794000993 174431.73679888, "
            "172598.17194137024 174432.53079564194, "
            "172597.70394001 174433.63779889003, "
            "172598.2660748735 174435.35474717614, "
            "172601.1998381591 174434.5913030442, "
            "172601.19995467947 174434.5917172166, "
            "172601.68394000002 174434.46579888, "
            "172602.63794000942 174437.85679888783, "
            "172603.5209395613 174441.3317971537, "
            "172603.67147661696 174441.92469197488, "
            "172604.18799165756 174443.95900234475, "
            "172607.0539523896 174443.2048484512, "
            "172608.01694001004 174447.05779888, "
            "172602.61494001004 174448.18279888007, "
            "172603.57694000003 174451.96779887998, "
            "172591.37294001 174454.98979887998, "
            "172593.09693550566 174460.86278353556, "
            "172605.0632588789 174457.8183631897, "
            "172608.39689087868 174456.97023519131, "
            "172613.0762718963 174455.77972994547, "
            "172613.07636302974 174455.78010138884, "
            "172613.56094001004 174455.65679887997, "
            "172614.32594000004 174458.77479888004, "
            "172609.11894000994 174459.86879888005, "
            "172606.47194360537 174460.59979788712, "
            "172604.45794001 174461.15679888, "
            "172605.3409823247 174464.7719721671, "
            "172612.59480380098 174462.95596724018, "
            "172612.7014123517 174462.92927763195, "
            "172613.07994000003 174462.83479889008, "
            "172613.61893907966 174464.88379535347, "
            "172613.6189968665 174464.88401470726, "
            "172614.04993903125 174466.51979517483, "
            "172614.37794 174467.76679889, "
            "172612.53894704106 174468.36579659986, "
            "172612.53852629993 174468.36593398513, "
            "172611.16394366286 174468.81479768714, "
            "172608.52993999998 174469.67379888, "
            "172609.11193880375 174471.76679455204, "
            "172609.11197085044 174471.76690999718, "
            "172609.56229931235 174473.38928541902, "
            "172609.5649399964 174473.3987988771, "
            "172612.91284623384 174485.5614581992, "
            "172616.49161088464 174484.6038992107, "
            "172617.37810321042 174484.36670035287, "
            "172617.3781038362 174484.3667001854, "
            "172617.40430078932 174484.35969066346, "
            "172621.91801405355 174483.1519558644, "
            "172625.84397284017 174482.10148660126, "
            "172626.28639576584 174481.983107446, "
            "172629.84245889643 174481.0316112079, "
            "172629.84260632202 174481.0318919951, "
            "172641.95148947238 174477.65292460908, "
            "172641.9513229055 174477.65228320664, "
            "172643.55453783524 174477.22348398916, "
            "172649.45557890835 174475.6451792046, "
            "172652.118800357 174474.93285825956, "
            "172655.08757891503 174474.13881120458, "
            "172669.09820291854 174470.39141919912, "
            "172673.91823492196 174469.15141920003, "
            "172674.05039449205 174469.04677954124, "
            "172674.1582349241 174468.9614031985, "
            "172675.5150722086 174468.60274051016, "
            "172675.58914901028 174468.58315924928, "
            "172676.93838271403 174468.22650647085, "
            "172685.4841995281 174465.9675284286, "
            "172690.08649093658 174464.75097119805, "
            "172690.35773174433 174464.679270439, "
            "172693.6036109403 174463.82124319673, "
            "172695.45967493954 174467.2931151986, "
            "172695.69615282057 174467.73546474247, "
            "172695.8858936043 174468.09038905406, "
            "172702.29378802062 174480.0768342967, "
            "172712.67227422315 174477.65895398633, "
            "172712.67215495606 174477.6584912053, "
            "172719.8562189564 174475.80549920353, "
            "172719.13622944942 174473.1791069913, "
            "172719.19547385076 174473.1660017983, "
            "172719.07393999997 174472.68079888003, "
            "172722.78994000095 174471.8587988898, "
            "172723.6209313099 174471.64980106562, "
            "172723.62116079254 174471.6497431358, "
            "172726.34993987996 174470.9607989128, "
            "172727.68514120538 174470.623748284, "
            "172728.34493999486 174470.45779889126, "
            "172728.94593998056 174470.3107988972, "
            "172729.36494001048 174470.20779888984, "
            "172733.29694 174468.74879888006, "
            "172732.51594000997 174463.94179888, "
            "172736.18094000997 174462.86079888, "
            "172736.12094 174460.75779888, "
            "172739.38593999937 174460.04779889015, "
            "172751.74194 174457.62979889003, "
            "172751.82374942137 174457.8052091417, "
            "172760.30108298364 174475.9976912029, "
            "172767.25628262636 174472.6322513803, "
            "172767.5851149932 174472.47314720228, "
            "172767.50690699372 174472.13401120156, "
            "172767.1188087445 174472.3620791199, "
            "172766.30993999983 174470.7767988602, "
            "172765.64794001004 174469.48679887998, "
            "172766.51694001004 174469.12679887997, "
            "172765.12794 174466.03679888998, "
            "172764.34694001 174466.34679888003, "
            "172762.84694005293 174463.15679897126, "
            "172763.29320167168 174462.94189765144, "
            "172764.2839314731 174462.46480300103, "
            "172765.32593999998 174461.96179887993, "
            "172761.1385378274 174453.29491927216, "
            "172761.13853782744 174453.29491927216, "
            "172760.09694000988 174451.01679888976, "
            "172759.79494001003 174450.12279889, "
            "172760.93594000998 174449.76179888003, "
            "172761.82593999995 174450.27579889004, "
            "172762.67400122888 174449.91177263303, "
            "172765.15694 174448.84679888003, "
            "172764.19994000997 174445.99879888, "
            "172764.60994001062 174445.80279888492, "
            "172764.33894001 174444.31479887993, "
            "172763.51689098784 174441.74149918192, "
            "172763.5168882326 174441.74150007046, "
            "172763.51688823258 174441.74150007026, "
            "172763.21993999998 174440.02779889002, "
            "172761.17694 174440.68879888, "
            "172759.74790522835 174436.7047019099, "
            "172755.11890209024 174438.21366147915, "
            "172754.95691696025 174437.6267152474, "
            "172754.85751089564 174437.26601325686, "
            "172754.6069400003 174436.3567988909, "
            "172755.10336595034 174436.22560282986, "
            "172756.19993908802 174435.93579913364, "
            "172758.35593845724 174435.36579929787, "
            "172760.84694000997 174434.70679888004, "
            "172760.58894161868 174433.5358061814, "
            "172760.14693999995 174431.53679888978, "
            "172759.5329400001 174429.6077988801, "
            "172759.52534339868 174429.53306474834, "
            "172759.48582006822 174429.1442406328, "
            "172759.76815493542 174429.05234718855, "
            "172759.7528128644 174429.0162936086, "
            "172759.12745483534 174427.54860076858, "
            "172759.12745462733 174427.54860004058, "
            "172759.1267469823 174427.54693917185, "
            "172759.12695293076 174427.54684410253, "
            "172758.76693612643 174426.28678529424, "
            "172758.12194001 174424.02879888, "
            "172758.32293999995 174423.95879888002, "
            "172758.05193999998 174421.82179889004, "
            "172756.6439400104 174422.12379887994, "
            "172756.53950232168 174422.15535105282, "
            "172755.98194000003 174422.32379888996, "
            "172755.12451175836 174419.47773878835, "
            "172753.83321806323 174419.78523359896, "
            "172752.4939518636 174414.58684488994, "
            "172751.20706697553 174414.83333916217, "
            "172750.73129098117 174412.7877071612, "
            "172748.95247497407 174413.2481231615, "
            "172748.47247497732 174411.39813916016, "
            "172753.23247498277 174410.11813915893, "
            "172751.57647497955 174404.02937115356, "
            "172750.80501897636 174401.19289115068, "
            "172749.21920579113 174395.36230315745, "
            "172749.2194832201 174395.36220860117, "
            "172749.08793999997 174394.87879889001, "
            "172750.24394001003 174394.48479888003, "
            "172751.79493705663 174393.68580041145, "
            "172753.32194001004 174392.89979888, "
            "172754.02694001 174394.06179887996, "
            "172759.86194000999 174390.84279887998, "
            "172760.84694001003 174392.75779887996, "
            "172762.75293454644 174391.80780159816, "
            "172762.7540957816 174391.80722369105, "
            "172764.6779369368 174390.84980040943, "
            "172767.0349380484 174389.675799857, "
            "172769.10393896094 174388.64579940226, "
            "172770.8269400001 174387.78779888, "
            "172772.41231297184 174387.0021096416, "
            "172769.92245898946 174381.99321113512, "
            "172769.86473163788 174381.87794843127, "
            "172766.27740298968 174374.71225113448, "
            "172766.12751504182 174374.37625125528, "
            "172765.45154720507 174372.86111561494, "
            "172764.5623949914 174370.86834713045, "
            "172758.44661898166 174358.71346712485, "
            "172758.08089647835 174357.9866221479, "
            "172758.0812897689 174357.9865175769, "
            "172757.8519399999 174357.5307988898, "
            "172754.4110373197 174349.3873883099, "
            "172754.41083817216 174349.3874620819, "
            "172754.04609390008 174348.52429801252, "
            "172753.7164504677 174347.74419976756, "
            "172753.71289365587 174347.7351269625, "
            "172752.91599497944 174345.84914711493, "
            "172752.96828298277 174345.83532311398, "
            "172752.74697099614 174345.2712271516, "
            "172750.88521097507 174340.5253711095, "
            "172749.90261897308 174337.94073110458, "
            "172742.68309897187 174319.57548309487, "
            "172729.2444429621 174323.76869909838, "
            "172729.1040909663 174323.3482191004, "
            "172719.76546695834 174325.91705109927, "
            "172721.48245895657 174332.9833551049, "
            "172723.08294328308 174339.57013976108, "
            "172723.03791828503 174339.58436050604, "
            "172723.15793999998 174340.07079887998, "
            "172719.07994 174341.35879888994, "
            "172719.0331842302 174340.8492201192, "
            "172718.5874979483 174340.98998616525, "
            "172718.5534989536 174340.6227151118, "
            "172714.9709069505 174341.62623511252, "
            "172702.72073094547 174345.05746711424, "
            "172703.20898694542 174346.73209111392, "
            "172703.9096589461 174349.13503511623, "
            "172695.26953093708 174351.39500311756, "
            "172694.93771905327 174349.74538306356, "
            "172692.57990415473 174350.34580801197, "
            "172692.57334559556 174350.34747709305, "
            "172689.68390132912 174351.0828087242, "
            "172689.6768192437 174351.08460978328, "
            "172686.95894150986 174351.77579850602, "
            "172684.89594078047 174352.3007986814, "
            "172684.8828689878 174352.30412604674, "
            "172683.3009262921 174352.70680236846, "
            "172681.18281584515 174353.24583040207, "
            "172679.3319479569 174353.71579686215, "
            "172677.40094000465 174354.20779888882, "
            "172677.27266865686 174353.73419735025, "
            "172676.77394073328 174351.89280155062, "
            "172676.06193873903 174349.26679423897, "
            "172675.7409324217 174348.08277088706, "
            "172675.25994054292 174346.30780088357, "
            "172675.2596599193 174346.30676614863, "
            "172674.46692653303 174343.38374918967, "
            "172673.58194064876 174340.11780124725, "
            "172672.77094000002 174337.12779888004, "
            "172670.9499049531 174337.60880813404, "
            "172670.52563620973 174337.72080595847, "
            "172669.09919766168 174338.09735505903, "
            "172669.08994002102 174338.09979887708, "
            "172668.25594001057 174338.3197988899, "
            "172663.54094 174339.43779888, "
            "172663.9509396747 174340.9917976469, "
            "172663.95246609734 174340.9975798821, "
            "172664.37093995474 174342.5827987186, "
            "172664.9449393093 174344.75679626403, "
            "172665.47293987044 174346.75879839866, "
            "172665.473080069 174346.7593299183, "
            "172666.08593904617 174349.08279523588, "
            "172666.0860074876 174349.08305431984, "
            "172666.77093856825 174351.67579347026, "
            "172667.44093999997 174354.21779888, "
            "172665.21794001 174354.76179888, "
            "172665.0101183685 174354.8126524625, "
            "172663.37894000002 174355.21179888002, "
            "172663.37873282918 174355.21184957805, "
            "172661.5809427116 174355.65179822646, "
            "172659.15894248072 174356.2437982761, "
            "172656.24094000997 174356.95779889004, "
            "172655.8289405051 174354.98780124754, "
            "172655.30694000996 174352.49479888997, "
            "172654.75393999997 174349.85379887992, "
            "172653.44093999994 174347.26779887994, "
            "172650.79094000012 174346.37779887998, "
            "172649.39294039877 174346.74579877505, "
            "172649.3911846923 174346.7462610297, "
            "172648.1699417751 174347.06779842527, "
            "172643.14494001 174348.38979889, "
            "172642.93389291374 174348.44532466854, "
            "172640.56794000996 174349.06779889, "
            "172640.41789637046 174349.10727144754, "
            "172638.06294 174349.72679888003, "
            "172635.8089427633 174350.319798163, "
            "172634.01694338908 174350.79179799, "
            "172631.56094000998 174351.43779888997, "
            "172631.68094001 174351.69779888, "
            "172630.46894738195 174352.0517967368, "
            "172630.4687520214 174352.05185395735, "
            "172629.2809437475 174352.39979778518, "
            "172627.68094000997 174352.86779889, "
            "172628.10093847304 174354.1197943085, "
            "172628.10107294662 174354.1201945294, "
            "172628.6879379874 174355.86679290008, "
            "172628.68799114702 174355.86695143604, "
            "172629.43093933648 174358.08279688127, "
            "172629.43133035954 174358.0839622848, "
            "172630.24693959064 174360.5147976402, "
            "172630.24792235918 174360.51772822303, "
            "172630.85693939638 174362.3337970801, "
            "172631.76094 174365.02779888996, "
            "172632.43094001003 174364.86779888996, "
            "172632.93494001002 174366.67479888993, "
            "172630.87694000924 174367.2867988902, "
            "172629.35094510994 174367.69579751312, "
            "172629.35049890392 174367.69591735688, "
            "172627.54894514213 174368.17979751158, "
            "172627.52128803954 174368.18721035263, "
            "172625.4409402792 174368.7447988152, "
            "172625.43971959242 174368.74512604062, "
            "172623.82194391786 174369.17879783243, "
            "172621.82194405483 174369.715797794, "
            "172621.82183787943 174369.71582625585, "
            "172620.13194178292 174370.16879840213, "
            "172618.52894290345 174370.59879811114, "
            "172616.85694000009 174371.04679887995, "
            "172613.67694 174372.43679888, "
            "172612.2709414281 174372.87179843814, "
            "172610.70894325845 174373.35479788246, "
            "172608.85694 174373.92679889, "
            "172608.25794049533 174371.89080052968, "
            "172607.82694000003 174370.42679889002, "
            "172607.51030628625 174370.515852122, "
            "172607.38694001004 174370.06679887997, "
            "172607.01194001 174368.70179888996, "
            "172605.61394000004 174369.12679888998, "
            "172604.29194001 174364.49979887996, "
            "172605.79494001003 174364.27579888995, "
            "172604.95794001003 174361.23079889003, "
            "172604.15693999996 174358.31679887997, "
            "172601.3829428521 174359.08279810517, "
            "172600.24729543962 174359.3960325686, "
            "172597.84457264078 174350.6279695617, "
            "172597.51694001004 174350.71679888997, "
            "172593.94294000993 174351.68579889, "
            "172594.4599387648 174353.5957943269, "
            "172594.89194001 174355.18879888, "
            "172594.43694 174355.28679888998, "
            "172595.10393895835 174357.58879525043, "
            "172595.61693890326 174359.35679511022, "
            "172596.36993943545 174361.95579694142, "
            "172596.92693999998 174363.87679887997, "
            "172594.25694 174364.45679887995, "
            "172594.21693999998 174364.31679888006, "
            "172593.00494592657 174364.6537972349, "
            "172593.00452690053 174364.65391402238, "
            "172592.00394302807 174364.932798036, "
            "172590.26894162453 174365.41579843775, "
            "172588.36994388918 174365.94479780665, "
            "172588.36984125132 174365.94482635465, "
            "172586.29894001002 174366.52079888002, "
            "172585.7109407086 174364.2888015419, "
            "172585.71082483808 174364.2883622034, "
            "172585.01994076036 174361.66880173524, "
            "172584.8667329185 174361.0872324162, "
            "172584.37794 174359.23179888996, "
            "172583.4569404406 174355.73580051467, "
            "172582.56193999999 174352.34079887997, "
            "172581.81194 174349.49579887997, "
            "172578.96056568567 174350.36739802494, "
            "172585.1382444169 174374.19050227254, "
            "172585.0614705477 174374.21335843968, "
            "172585.18994 174374.69679888996, "
            "172581.69994000997 174375.73579888, "
            "172581.62350512363 174375.3929519558, "
            "172581.93994000004 174374.65479888, "
            "172582.48094 174373.39279888003, "
            "172580.61794 174366.54279888, "
            "172576.77667659082 174367.3948403584, "
            "172578.3008907684 174373.35775476237, "
            "172578.52405885607 174374.23071513322, "
            "172580.47195049844 174381.85118837637, "
            "172580.4625612569 174381.85333750857, "
            "172580.58694000004 174382.33779888, "
            "172578.45494 174382.82579888, "
            "172576.95294001 174376.09679888003, "
            "172576.23194 174376.15679888002, "
            "172575.20993999997 174372.55179889, "
            "172573.66458694366 174372.8308626458, "
            "172574.0934668556 174374.3819471337, "
            "172574.33365876754 174375.25074680167, "
            "172574.7994377378 174376.93505831185, "
            "172574.46694027368 174377.10679874866, "
            "172573.55473542705 174377.38586125555, "
            "172571.95794220705 174377.87279822002, "
            "172569.12694000997 174378.73679888004, "
            "172570.29693999997 174382.59679888, "
            "172569.06894000657 174382.95779888806, "
            "172568.98899089158 174382.9810527852, "
            "172567.62494267538 174383.37779810186, "
            "172566.1759413303 174383.7987985035, "
            "172564.9709467131 174384.14879693012, "
            "172563.53494001646 174384.5647988781, "
            "172562.23594001002 174384.94279888997, "
            "172561.03905731053 174385.28960586703, "
            "172554.56188284606 174386.74853914225, "
            "172555.21404284242 174388.99244314435, "
            "172557.3838523062 174396.45835165278)),"
            "((172739.38594000007 174460.04779889, "
            "172739.39373637483 174460.04610350684, "
            "172739.392673916 174460.04121769255, "
            "172739.3870486459 174460.03837656736, "
            "172739.38261013498 174460.0403655549, "
            "172739.3807950899 174460.03631378766, "
            "172739.37623201194 174460.03835788142, "
            "172739.37262919155 174460.04530889943, "
            "172739.37358944913 174460.05021582366, "
            "172739.3858038434 174460.04782553512, "
            "172739.3859399994 174460.04779889015, "
            "172739.38594000007 174460.04779889)))"
        )
        result = safe_difference(polygon_a, polygon_b)  # GEOS exception is caught
        self.assertTrue(result.is_valid)

    def test_safe_symmetric_difference(self):
        """Tests safe_symmetric_difference with two disjoint polygons."""
        polygon_a = Polygon([(0, 0), (1, 0), (1, 1), (0, 1)])
        polygon_b = Polygon([(2, 2), (3, 2), (3, 3), (2, 3)])
        result = safe_symmetric_difference(polygon_a, polygon_b)
        self.assertTrue(result.is_valid)

    def test_safe_symmetric_difference_geos_exception(self):
        """Tests safe_symmetric_difference with a geos exception."""

        polygon_a = from_wkt(
            "MULTIPOLYGON(((172767.25694 174472.63279888, "
            "172766.30994001 174470.77679888, "
            "172765.64794001 174469.48679888, "
            "172766.51694001 174469.12679888, "
            "172765.12794 174466.03679889, "
            "172764.34694001 174466.34679888, "
            "172762.84694001 174463.15679888, "
            "172764.28394001 174462.46479889, "
            "172765.32594 174461.96179888, "
            "172761.13894 174453.29579888, "
            "172760.09694001 174451.01679889, "
            "172759.79494001 174450.12279889, "
            "172760.93594001 174449.76179888, "
            "172761.82594 174450.27579889, "
            "172762.67394001 174449.91179889, "
            "172765.15694 174448.84679888, "
            "172764.19994001 174445.99879888, "
            "172764.60994 174445.80279889, "
            "172764.33894001 174444.31479888, "
            "172763.51694001 174441.74179888, "
            "172763.21994 174440.02779889, "
            "172761.17694 174440.68879888, "
            "172759.74794001 174436.70479888, "
            "172759.02694001 174436.93979888, "
            "172756.96694 174437.61179889, "
            "172755.11894001 174438.21379888, "
            "172754.95694001 174437.62679889, "
            "172754.60694 174436.35679889, "
            "172756.19994001 174435.93579889, "
            "172758.35594 174435.36579889, "
            "172760.84694001 174434.70679888, "
            "172760.58894001 174433.53579888, "
            "172760.14694 174431.53679889, "
            "172759.53294 174429.60779888, "
            "172759.38494 174428.15179888, "
            "172759.12694001 174427.54679888, "
            "172758.76694001 174426.28679889, "
            "172758.12194001 174424.02879888, "
            "172758.32294 174423.95879888, "
            "172758.05194 174421.82179889, "
            "172756.64394001 174422.12379888, "
            "172755.98194 174422.32379889, "
            "172755.12694001 174419.48579888, "
            "172753.83594001 174419.79579889, "
            "172752.49394001 174414.58679888, "
            "172751.20794001 174414.83379888, "
            "172750.65294001 174412.80779888, "
            "172748.95294001 174413.24779889, "
            "172748.47294 174411.39879889, "
            "172753.23294001 174410.11879888, "
            "172752.77094 174408.42079889, "
            "172752.20594 174406.34079888, "
            "172751.57694 174404.02979888, "
            "172750.94994001 174401.72379889, "
            "172750.44494 174399.86779889, "
            "172749.65394 174396.95879888, "
            "172749.08794 174394.87879889, "
            "172750.24394001 174394.48479888, "
            "172751.79494001 174393.68579889, "
            "172753.32194001 174392.89979888, "
            "172754.02694001 174394.06179888, "
            "172759.86194001 174390.84279888, "
            "172760.84694001 174392.75779888, "
            "172762.75294 174391.80779888, "
            "172764.67794001 174390.84979888, "
            "172767.03494001 174389.67579888, "
            "172769.10394001 174388.64579888, "
            "172770.82694 174387.78779888, "
            "172772.41294001 174387.00179889, "
            "172771.70694001 174385.58179888, "
            "172770.47494001 174383.10379888, "
            "172769.86494001 174381.87779888, "
            "172769.31094001 174380.77179889, "
            "172768.51694001 174379.18579889, "
            "172767.43494001 174377.02279888, "
            "172766.27794001 174374.71279889, "
            "172765.78994 174373.61879888, "
            "172765.24294 174372.39279888, "
            "172764.56294 174370.86879888, "
            "172763.48394 174368.72379889, "
            "172762.58994001 174366.94779889, "
            "172761.36994 174364.52279888, "
            "172760.27094 174362.33879888, "
            "172759.15994001 174360.12979888, "
            "172757.85194 174357.53079889, "
            "172752.91594 174345.84979888, "
            "172752.44494 174344.50079888, "
            "172751.68294 174342.55779888, "
            "172750.88594 174340.52579889, "
            "172749.87694001 174337.94779888, "
            "172748.82694 174335.20279888, "
            "172747.72094 174332.38879888, "
            "172746.51294001 174329.31579889, "
            "172745.36494001 174326.39779888, "
            "172743.82194001 174322.47179888, "
            "172742.68394 174319.57579888, "
            "172739.86294 174320.46079888, "
            "172737.67194 174320.96779888, "
            "172736.12194001 174321.39879889, "
            "172733.90294001 174322.01479889, "
            "172731.21594 174322.76179888, "
            "172729.70094 174323.15779889, "
            "172729.10494001 174323.34879888, "
            "172727.50294 174323.86079888, "
            "172724.60494001 174324.78679888, "
            "172719.82894001 174326.31279889, "
            "172720.17794001 174327.77779889, "
            "172720.41094 174328.75779888, "
            "172720.82494001 174330.49979889, "
            "172721.08494 174331.56079889, "
            "172721.42594 174332.98579888, "
            "172721.70594 174334.18179888, "
            "172722.03394001 174335.51479889, "
            "172722.60994 174337.84979888, "
            "172723.15794 174340.07079888, "
            "172719.07994 174341.35879889, "
            "172719.00094001 174340.49779889, "
            "172718.62994001 174340.60179888, "
            "172717.50294 174340.91679888, "
            "172714.97094 174341.62679888, "
            "172714.17294 174341.84979888, "
            "172712.47094 174342.32679888, "
            "172710.41394001 174342.90279889, "
            "172708.33894001 174343.48379889, "
            "172705.43894001 174344.29679888, "
            "172702.72094 174345.05779888, "
            "172703.36294 174347.25779888, "
            "172703.90994001 174349.13479888, "
            "172702.14294 174349.59779889, "
            "172700.29694 174350.08079888, "
            "172697.39194001 174350.83979889, "
            "172695.26994001 174351.39479888, "
            "172694.94394 174349.74379888, "
            "172692.57994 174350.34579889, "
            "172689.68394 174351.08279889, "
            "172686.95894 174351.77579889, "
            "172684.89594 174352.30079888, "
            "172683.30094 174352.70679888, "
            "172681.18294 174353.24579888, "
            "172679.33194001 174353.71579888, "
            "172677.40094 174354.20779889, "
            "172676.77394001 174351.89279888, "
            "172676.06194 174349.26679889, "
            "172675.74094001 174348.08279889, "
            "172675.25994 174346.30779888, "
            "172674.46694 174343.38379889, "
            "172673.58194001 174340.11779889, "
            "172672.77094 174337.12779888, "
            "172670.94994001 174337.60879888, "
            "172669.08994001 174338.09979888, "
            "172668.25594001 174338.31979889, "
            "172663.54094 174339.43779888, "
            "172663.95094 174340.99179888, "
            "172664.37094 174342.58279889, "
            "172664.94494 174344.75679888, "
            "172665.47294 174346.75879889, "
            "172666.08594001 174349.08279889, "
            "172666.77094 174351.67579889, "
            "172667.44094 174354.21779888, "
            "172665.21794001 174354.76179888, "
            "172663.37894 174355.21179888, "
            "172661.58094 174355.65179889, "
            "172659.15894001 174356.24379888, "
            "172656.24094001 174356.95779889, "
            "172655.82894001 174354.98779888, "
            "172655.30694001 174352.49479889, "
            "172654.75394 174349.85379888, "
            "172653.44094 174347.26779888, "
            "172650.79094 174346.37779888, "
            "172649.39294 174346.74579888, "
            "172648.16994001 174347.06779889, "
            "172643.14494001 174348.38979889, "
            "172640.56794001 174349.06779889, "
            "172638.06294 174349.72679888, "
            "172635.80894 174350.31979889, "
            "172634.01694001 174350.79179888, "
            "172631.56094001 174351.43779889, "
            "172631.68094001 174351.69779888, "
            "172630.46894001 174352.05179889, "
            "172629.28094001 174352.39979888, "
            "172627.68094001 174352.86779889, "
            "172628.10094001 174354.11979889, "
            "172628.68794 174355.86679889, "
            "172629.43094001 174358.08279889, "
            "172630.24694001 174360.51479889, "
            "172630.85694 174362.33379888, "
            "172631.76094 174365.02779889, "
            "172632.43094001 174364.86779889, "
            "172632.93494001 174366.67479889, "
            "172630.87694001 174367.28679889, "
            "172629.35094001 174367.69579888, "
            "172627.54894001 174368.17979889, "
            "172625.44094 174368.74479889, "
            "172623.82194001 174369.17879888, "
            "172621.82194001 174369.71579888, "
            "172620.13194 174370.16879888, "
            "172618.52894 174370.59879889, "
            "172616.85694 174371.04679888, "
            "172613.67694 174372.43679888, "
            "172612.27094 174372.87179888, "
            "172610.70894 174373.35479889, "
            "172608.85694 174373.92679889, "
            "172608.25794001 174371.89079888, "
            "172607.82694 174370.42679889, "
            "172607.50694 174370.51679889, "
            "172607.38694001 174370.06679888, "
            "172607.01194001 174368.70179889, "
            "172605.61394 174369.12679889, "
            "172604.29194001 174364.49979888, "
            "172605.79494001 174364.27579889, "
            "172604.95794001 174361.23079889, "
            "172604.15694 174358.31679888, "
            "172601.38294001 174359.08279889, "
            "172599.73694001 174359.53679889, "
            "172599.03094001 174356.96479888, "
            "172598.45694001 174354.87679889, "
            "172598.31094001 174353.65579888, "
            "172597.92494001 174352.22579889, "
            "172597.51694001 174350.71679889, "
            "172593.94294001 174351.68579889, "
            "172594.45994 174353.59579889, "
            "172594.89194001 174355.18879888, "
            "172594.43694 174355.28679889, "
            "172595.10394001 174357.58879888, "
            "172595.61694 174359.35679889, "
            "172596.36994 174361.95579889, "
            "172596.92694 174363.87679888, "
            "172594.25694 174364.45679888, "
            "172594.21694 174364.31679888, "
            "172593.00494001 174364.65379888, "
            "172592.00394 174364.93279888, "
            "172590.26894 174365.41579889, "
            "172588.36994 174365.94479889, "
            "172586.29894001 174366.52079888, "
            "172585.71094001 174364.28879889, "
            "172585.01994001 174361.66879889, "
            "172584.37794 174359.23179889, "
            "172583.45694001 174355.73579888, "
            "172582.56194 174352.34079888, "
            "172581.81194 174349.49579888, "
            "172578.83494 174350.40579889, "
            "172579.40794 174352.63579888, "
            "172579.78994 174354.11679888, "
            "172580.28794001 174356.05279889, "
            "172580.77094 174357.92779888, "
            "172581.47694 174360.66679888, "
            "172581.97094 174362.58679888, "
            "172582.24294 174363.61779889, "
            "172582.54194001 174364.74379888, "
            "172582.91294001 174366.13879888, "
            "172583.24094001 174367.37179888, "
            "172583.56894 174368.60379888, "
            "172583.98394 174370.16379889, "
            "172584.46094001 174371.95479888, "
            "172584.86494001 174373.47379888, "
            "172585.18994 174374.69679889, "
            "172581.69994001 174375.73579888, "
            "172581.45894 174374.65479888, "
            "172581.93994 174374.65479888, "
            "172582.48094 174373.39279888, "
            "172580.61794 174366.54279888, "
            "172576.54694 174367.44579888, "
            "172576.96094001 174368.82979888, "
            "172577.49594 174370.61579889, "
            "172578.20294001 174372.70579888, "
            "172578.57394 174374.21879889, "
            "172578.69794 174374.72879888, "
            "172578.94194001 174375.71979888, "
            "172579.21594 174376.83779888, "
            "172579.48694001 174377.94179888, "
            "172579.78194 174379.14479889, "
            "172580.08194001 174380.37079888, "
            "172580.58694 174382.33779888, "
            "172578.45494 174382.82579888, "
            "172576.95294001 174376.09679888, "
            "172576.23194 174376.15679888, "
            "172575.20994 174372.55179889, "
            "172573.66494 174372.83079889, "
            "172574.33394 174375.25079888, "
            "172574.79994001 174376.93479888, "
            "172574.46694 174377.10679889, "
            "172573.55494 174377.38579888, "
            "172571.95794001 174377.87279889, "
            "172569.12694001 174378.73679888, "
            "172570.29694 174382.59679888, "
            "172569.06894 174382.95779889, "
            "172567.62494 174383.37779888, "
            "172566.17594 174383.79879889, "
            "172564.97094 174384.14879888, "
            "172563.53494001 174384.56479888, "
            "172562.23594001 174384.94279889, "
            "172561.03494001 174385.29079889, "
            "172559.35194 174385.66979888, "
            "172558.39794001 174385.88479888, "
            "172556.63694001 174386.28179888, "
            "172554.56194 174386.74879888, "
            "172554.93394 174388.02679888, "
            "172555.33194001 174389.39779888, "
            "172555.78394001 174390.95079888, "
            "172556.25094001 174392.55979888, "
            "172556.78094001 174394.38279888, "
            "172557.38394001 174396.45779889, "
            "172555.12994001 174410.66979888, "
            "172554.04194001 174412.21079889, "
            "172554.18094001 174413.74279889, "
            "172554.35894 174415.69279889, "
            "172554.59094 174418.23979888, "
            "172554.80294001 174420.57479888, "
            "172555.02794001 174423.04279888, "
            "172555.93294 174422.97279889, "
            "172557.54494001 174422.84879889, "
            "172560.00094001 174422.89679889, "
            "172562.04294 174422.83779889, "
            "172563.99094001 174422.77979888, "
            "172565.29094 174422.74079889, "
            "172567.21594 174422.68179889, "
            "172569.10194 174422.62379888, "
            "172568.98294001 174421.27879888, "
            "172568.88094001 174420.13579889, "
            "172568.73194 174418.45579889, "
            "172568.45294001 174415.31879888, "
            "172570.64394 174415.21279889, "
            "172570.64394001 174420.55979889, "
            "172572.08594001 174420.43979888, "
            "172572.08594001 174421.46179888, "
            "172572.89894001 174421.52179889, "
            "172572.93594001 174418.69679889, "
            "172572.92794001 174415.53279888, "
            "172575.20994 174415.51279889, "
            "172575.27294001 174421.23079888, "
            "172577.66994001 174421.37079888, "
            "172577.71794001 174420.68179889, "
            "172577.72494001 174418.93679889, "
            "172577.73594001 174415.93279888, "
            "172580.01694001 174415.87379888, "
            "172579.83694 174420.49979889, "
            "172581.27894 174420.49979889, "
            "172581.16094 174421.60179888, "
            "172582.17694 174421.66979888, "
            "172582.13594 174422.43279888, "
            "172582.06294 174423.81779889, "
            "172581.85494001 174425.10579888, "
            "172581.54394 174425.96979888, "
            "172582.27094 174425.90879888, "
            "172583.34994001 174425.81679888, "
            "172584.44594001 174425.72479888, "
            "172585.57394 174425.43879889, "
            "172587.27294001 174425.00679888, "
            "172589.82794001 174424.35879889, "
            "172589.40294001 174423.53179888, "
            "172589.03494001 174422.06079888, "
            "172588.59694001 174420.30879889, "
            "172588.35594 174419.34679888, "
            "172587.97694 174417.82879889, "
            "172587.78294 174417.05679889, "
            "172587.61594001 174415.77979888, "
            "172587.36494001 174414.35979888, "
            "172587.75394 174413.42079888, "
            "172587.86994 174411.44879889, "
            "172592.26794 174410.32279888, "
            "172592.57794001 174412.11779889, "
            "172593.54694 174411.85679889, "
            "172593.88294001 174413.17479889, "
            "172596.71694 174412.45279888, "
            "172597.50594001 174415.42779888, "
            "172593.94094 174416.36279888, "
            "172594.31794001 174417.67579888, "
            "172595.57994 174417.37579888, "
            "172595.88594 174418.96979888, "
            "172599.56994 174418.29279888, "
            "172600.39494001 174421.68079888, "
            "172599.12494 174422.00279888, "
            "172597.83994001 174422.32779888, "
            "172595.25594001 174422.98279888, "
            "172595.67794001 174424.90679888, "
            "172598.81094001 174424.21879889, "
            "172599.32294 174426.26379888, "
            "172599.83994001 174428.32779888, "
            "172600.28294 174430.09379889, "
            "172599.53294 174430.30379888, "
            "172598.94794 174431.12079888, "
            "172598.50794001 174431.73679888, "
            "172598.17194 174432.53079888, "
            "172597.70394001 174433.63779889, "
            "172598.26694001 174435.35479889, "
            "172601.68394 174434.46579888, "
            "172602.63794001 174437.85679889, "
            "172603.52094 174441.33179888, "
            "172604.18794 174443.95879889, "
            "172607.05394 174443.20479888, "
            "172608.01694001 174447.05779888, "
            "172602.61494001 174448.18279888, "
            "172603.57694 174451.96779888, "
            "172591.37294001 174454.98979888, "
            "172593.09694001 174460.86279888, "
            "172596.00694 174460.12279889, "
            "172599.45294001 174459.24579888, "
            "172605.06394001 174457.81879888, "
            "172608.39694 174456.97079889, "
            "172613.56094001 174455.65679888, "
            "172614.32594 174458.77479888, "
            "172609.11894001 174459.86879888, "
            "172606.47194001 174460.59979888, "
            "172604.45794001 174461.15679888, "
            "172605.34094 174464.77179889, "
            "172607.57394 174464.20979889, "
            "172609.99094001 174463.60579889, "
            "172613.07994 174462.83479889, "
            "172613.61894001 174464.88379889, "
            "172614.04994001 174466.51979889, "
            "172614.37794 174467.76679889, "
            "172612.53894001 174468.36579889, "
            "172611.16394001 174468.81479888, "
            "172608.52994 174469.67379888, "
            "172609.11194001 174471.76679889, "
            "172609.56494 174473.39879889, "
            "172612.91294001 174485.56179888, "
            "172614.59894 174485.11079888, "
            "172617.38894 174484.36379889, "
            "172622.33194001 174483.04179888, "
            "172625.99594 174482.06079889, "
            "172629.84294001 174481.03179888, "
            "172641.95194 174477.65279889, "
            "172643.75494001 174477.16979888, "
            "172645.38894 174476.73279888, "
            "172647.53094001 174476.15979889, "
            "172649.87894 174475.53179888, "
            "172652.14894001 174474.92479889, "
            "172655.08794 174474.13879889, "
            "172656.82294 174473.67479889, "
            "172659.20494 174473.03779889, "
            "172661.12994001 174472.52279888, "
            "172663.13094001 174471.98779888, "
            "172666.07294 174471.20079888, "
            "172669.09894 174470.39179889, "
            "172670.32794001 174470.07579888, "
            "172672.24694001 174469.58179889, "
            "172673.91894 174469.15179888, "
            "172674.58694 174468.84879889, "
            "172675.52994 174468.59879889, "
            "172677.88094001 174467.97779889, "
            "172680.51794 174467.28079889, "
            "172683.39194001 174466.52079888, "
            "172686.88994 174465.59579889, "
            "172690.08694 174464.75079888, "
            "172693.60394001 174463.82179889, "
            "172694.71594 174465.90079889, "
            "172695.81494 174467.95779889, "
            "172696.76694001 174469.73679889, "
            "172698.74294 174473.43379889, "
            "172700.00894001 174475.80279888, "
            "172701.21194 174478.05279888, "
            "172702.29394 174480.07679889, "
            "172712.67294 174477.65879888, "
            "172714.31294 174477.23479888, "
            "172715.92294 174476.81879889, "
            "172718.15094 174476.24279889, "
            "172719.85594 174475.80279888, "
            "172719.07394 174472.68079888, "
            "172722.78994 174471.85879889, "
            "172723.62094 174471.64979888, "
            "172726.34994001 174470.96079888, "
            "172727.68494001 174470.62379888, "
            "172728.34494 174470.45779889, "
            "172728.94594001 174470.31079889, "
            "172729.36494001 174470.20779889, "
            "172733.29694 174468.74879888, "
            "172732.51594001 174463.94179888, "
            "172736.18094001 174462.86079888, "
            "172736.12094 174460.75779888, "
            "172739.38594 174460.04779889, "
            "172751.74194 174457.62979889, "
            "172752.52594 174459.31079889, "
            "172753.47194001 174461.34079888, "
            "172754.32394 174463.17079889, "
            "172755.22994001 174465.11479888, "
            "172756.45494 174467.74379888, "
            "172757.91194 174470.86979889, "
            "172759.17194 174473.57379889, "
            "172760.30194 174475.99779889, "
            "172767.25694 174472.63279888)))"
        )
        polygon_b = from_wkt(
            "MULTIPOLYGON(((172557.3838523062 174396.45835165278, "
            "172555.12905084348 174410.6693711578, "
            "172554.04105084387 174412.2103631608, "
            "172554.28937084228 174414.93676316369, "
            "172555.0277388468 174423.0425551683, "
            "172563.7369228527 174422.37100316587, "
            "172569.0432908535 174421.9618511684, "
            "172568.4963957805 174415.81728130922, "
            "172568.4972705121 174415.81723898993, "
            "172568.45294000994 174415.31879887995, "
            "172570.64394 174415.21279888996, "
            "172570.64394001 174420.55979889, "
            "172572.08594000997 174420.43979888, "
            "172572.08594000997 174420.94152719184, "
            "172572.77495595193 174420.8841888285, "
            "172572.71193637606 174416.03471118974, "
            "172572.929204253 174416.03280700246, "
            "172572.92794000998 174415.53279887998, "
            "172575.20994000003 174415.51279889, "
            "172575.27294001004 174421.23079888, "
            "172577.6697196799 174421.37078601134, "
            "172577.70199362023 174416.43384416474, "
            "172577.73410833202 174416.4330134905, "
            "172577.7358131635 174415.9674395041, "
            "172577.73594001 174415.93279888004, "
            "172578.87644000998 174415.90329888, "
            "172580.01694000998 174415.87379888, "
            "172579.83694 174420.49979889003, "
            "172581.27894 174420.49979889003, "
            "172581.22540097954 174420.99979889003, "
            "172582.22334147422 174420.99979889003, "
            "172582.17621886 174421.66917916582, "
            "172582.0176908598 174424.652603168, "
            "172581.5430028588 174425.96959516776, "
            "172581.36988285926 174426.44985117015, "
            "172583.22229886055 174426.393211171, "
            "172584.53372231862 174426.04524331444, "
            "172585.60137086362 174425.76191516966, "
            "172589.6888588667 174424.67730716988, "
            "172588.59657086435 174420.30905116722, "
            "172587.97628287587 174417.82828320874, "
            "172587.62773886323 174416.44255516306, "
            "172587.57641086724 174416.43890716136, "
            "172587.6150668636 174415.78034716102, "
            "172587.75349886715 174413.420987159, "
            "172587.86921086907 174411.4484431595, "
            "172591.77150026744 174410.4497097941, "
            "172592.26794067942 174410.3228028141, "
            "172592.57794001006 174412.11779889002, "
            "172593.54694000003 174411.85679889002, "
            "172593.88294001002 174413.17479889, "
            "172596.71693999998 174412.45279888005, "
            "172597.50594000999 174415.42779887991, "
            "172597.172895412 174415.51514718245, "
            "172597.022295644 174415.5546452982, "
            "172597.0224054087 174415.55505917643, "
            "172593.93199883454 174416.33165895962, "
            "172593.94094 174416.36279887997, "
            "172594.31794001002 174417.67579888002, "
            "172595.57994 174417.37579888004, "
            "172595.88594000004 174418.96979887996, "
            "172599.56993999996 174418.29279888, "
            "172600.39494000998 174421.68079888003, "
            "172599.91025387176 174421.80368780546, "
            "172599.94715650496 174421.95523461731, "
            "172596.69628287107 174422.8178511672, "
            "172595.3009759594 174423.18812865848, "
            "172595.67794001 174424.90679888, "
            "172598.81094000905 174424.2187988902, "
            "172598.92996166085 174424.6941881079, "
            "172599.32293973575 174426.26379782447, "
            "172599.32319430308 174426.26481412462, "
            "172599.83993917855 174428.32779556068, "
            "172600.28294000003 174430.09379889, "
            "172599.53294 174430.30379888, "
            "172598.9479399949 174431.12079888713, "
            "172598.50794000993 174431.73679888, "
            "172598.17194137024 174432.53079564194, "
            "172597.70394001 174433.63779889003, "
            "172598.2660748735 174435.35474717614, "
            "172601.1998381591 174434.5913030442, "
            "172601.19995467947 174434.5917172166, "
            "172601.68394000002 174434.46579888, "
            "172602.63794000942 174437.85679888783, "
            "172603.5209395613 174441.3317971537, "
            "172603.67147661696 174441.92469197488, "
            "172604.18799165756 174443.95900234475, "
            "172607.0539523896 174443.2048484512, "
            "172608.01694001004 174447.05779888, "
            "172602.61494001004 174448.18279888007, "
            "172603.57694000003 174451.96779887998, "
            "172591.37294001 174454.98979887998, "
            "172593.09693550566 174460.86278353556, "
            "172605.0632588789 174457.8183631897, "
            "172608.39689087868 174456.97023519131, "
            "172613.0762718963 174455.77972994547, "
            "172613.07636302974 174455.78010138884, "
            "172613.56094001004 174455.65679887997, "
            "172614.32594000004 174458.77479888004, "
            "172609.11894000994 174459.86879888005, "
            "172606.47194360537 174460.59979788712, "
            "172604.45794001 174461.15679888, "
            "172605.3409823247 174464.7719721671, "
            "172612.59480380098 174462.95596724018, "
            "172612.7014123517 174462.92927763195, "
            "172613.07994000003 174462.83479889008, "
            "172613.61893907966 174464.88379535347, "
            "172613.6189968665 174464.88401470726, "
            "172614.04993903125 174466.51979517483, "
            "172614.37794 174467.76679889, "
            "172612.53894704106 174468.36579659986, "
            "172612.53852629993 174468.36593398513, "
            "172611.16394366286 174468.81479768714, "
            "172608.52993999998 174469.67379888, "
            "172609.11193880375 174471.76679455204, "
            "172609.11197085044 174471.76690999718, "
            "172609.56229931235 174473.38928541902, "
            "172609.5649399964 174473.3987988771, "
            "172612.91284623384 174485.5614581992, "
            "172616.49161088464 174484.6038992107, "
            "172617.37810321042 174484.36670035287, "
            "172617.3781038362 174484.3667001854, "
            "172617.40430078932 174484.35969066346, "
            "172621.91801405355 174483.1519558644, "
            "172625.84397284017 174482.10148660126, "
            "172626.28639576584 174481.983107446, "
            "172629.84245889643 174481.0316112079, "
            "172629.84260632202 174481.0318919951, "
            "172641.95148947238 174477.65292460908, "
            "172641.9513229055 174477.65228320664, "
            "172643.55453783524 174477.22348398916, "
            "172649.45557890835 174475.6451792046, "
            "172652.118800357 174474.93285825956, "
            "172655.08757891503 174474.13881120458, "
            "172669.09820291854 174470.39141919912, "
            "172673.91823492196 174469.15141920003, "
            "172674.05039449205 174469.04677954124, "
            "172674.1582349241 174468.9614031985, "
            "172675.5150722086 174468.60274051016, "
            "172675.58914901028 174468.58315924928, "
            "172676.93838271403 174468.22650647085, "
            "172685.4841995281 174465.9675284286, "
            "172690.08649093658 174464.75097119805, "
            "172690.35773174433 174464.679270439, "
            "172693.6036109403 174463.82124319673, "
            "172695.45967493954 174467.2931151986, "
            "172695.69615282057 174467.73546474247, "
            "172695.8858936043 174468.09038905406, "
            "172702.29378802062 174480.0768342967, "
            "172712.67227422315 174477.65895398633, "
            "172712.67215495606 174477.6584912053, "
            "172719.8562189564 174475.80549920353, "
            "172719.13622944942 174473.1791069913, "
            "172719.19547385076 174473.1660017983, "
            "172719.07393999997 174472.68079888003, "
            "172722.78994000095 174471.8587988898, "
            "172723.6209313099 174471.64980106562, "
            "172723.62116079254 174471.6497431358, "
            "172726.34993987996 174470.9607989128, "
            "172727.68514120538 174470.623748284, "
            "172728.34493999486 174470.45779889126, "
            "172728.94593998056 174470.3107988972, "
            "172729.36494001048 174470.20779888984, "
            "172733.29694 174468.74879888006, "
            "172732.51594000997 174463.94179888, "
            "172736.18094000997 174462.86079888, "
            "172736.12094 174460.75779888, "
            "172739.38593999937 174460.04779889015, "
            "172751.74194 174457.62979889003, "
            "172751.82374942137 174457.8052091417, "
            "172760.30108298364 174475.9976912029, "
            "172767.25628262636 174472.6322513803, "
            "172767.5851149932 174472.47314720228, "
            "172767.50690699372 174472.13401120156, "
            "172767.1188087445 174472.3620791199, "
            "172766.30993999983 174470.7767988602, "
            "172765.64794001004 174469.48679887998, "
            "172766.51694001004 174469.12679887997, "
            "172765.12794 174466.03679888998, "
            "172764.34694001 174466.34679888003, "
            "172762.84694005293 174463.15679897126, "
            "172763.29320167168 174462.94189765144, "
            "172764.2839314731 174462.46480300103, "
            "172765.32593999998 174461.96179887993, "
            "172761.1385378274 174453.29491927216, "
            "172761.13853782744 174453.29491927216, "
            "172760.09694000988 174451.01679888976, "
            "172759.79494001003 174450.12279889, "
            "172760.93594000998 174449.76179888003, "
            "172761.82593999995 174450.27579889004, "
            "172762.67400122888 174449.91177263303, "
            "172765.15694 174448.84679888003, "
            "172764.19994000997 174445.99879888, "
            "172764.60994001062 174445.80279888492, "
            "172764.33894001 174444.31479887993, "
            "172763.51689098784 174441.74149918192, "
            "172763.5168882326 174441.74150007046, "
            "172763.51688823258 174441.74150007026, "
            "172763.21993999998 174440.02779889002, "
            "172761.17694 174440.68879888, "
            "172759.74790522835 174436.7047019099, "
            "172755.11890209024 174438.21366147915, "
            "172754.95691696025 174437.6267152474, "
            "172754.85751089564 174437.26601325686, "
            "172754.6069400003 174436.3567988909, "
            "172755.10336595034 174436.22560282986, "
            "172756.19993908802 174435.93579913364, "
            "172758.35593845724 174435.36579929787, "
            "172760.84694000997 174434.70679888004, "
            "172760.58894161868 174433.5358061814, "
            "172760.14693999995 174431.53679888978, "
            "172759.5329400001 174429.6077988801, "
            "172759.52534339868 174429.53306474834, "
            "172759.48582006822 174429.1442406328, "
            "172759.76815493542 174429.05234718855, "
            "172759.7528128644 174429.0162936086, "
            "172759.12745483534 174427.54860076858, "
            "172759.12745462733 174427.54860004058, "
            "172759.1267469823 174427.54693917185, "
            "172759.12695293076 174427.54684410253, "
            "172758.76693612643 174426.28678529424, "
            "172758.12194001 174424.02879888, "
            "172758.32293999995 174423.95879888002, "
            "172758.05193999998 174421.82179889004, "
            "172756.6439400104 174422.12379887994, "
            "172756.53950232168 174422.15535105282, "
            "172755.98194000003 174422.32379888996, "
            "172755.12451175836 174419.47773878835, "
            "172753.83321806323 174419.78523359896, "
            "172752.4939518636 174414.58684488994, "
            "172751.20706697553 174414.83333916217, "
            "172750.73129098117 174412.7877071612, "
            "172748.95247497407 174413.2481231615, "
            "172748.47247497732 174411.39813916016, "
            "172753.23247498277 174410.11813915893, "
            "172751.57647497955 174404.02937115356, "
            "172750.80501897636 174401.19289115068, "
            "172749.21920579113 174395.36230315745, "
            "172749.2194832201 174395.36220860117, "
            "172749.08793999997 174394.87879889001, "
            "172750.24394001003 174394.48479888003, "
            "172751.79493705663 174393.68580041145, "
            "172753.32194001004 174392.89979888, "
            "172754.02694001 174394.06179887996, "
            "172759.86194000999 174390.84279887998, "
            "172760.84694001003 174392.75779887996, "
            "172762.75293454644 174391.80780159816, "
            "172762.7540957816 174391.80722369105, "
            "172764.6779369368 174390.84980040943, "
            "172767.0349380484 174389.675799857, "
            "172769.10393896094 174388.64579940226, "
            "172770.8269400001 174387.78779888, "
            "172772.41231297184 174387.0021096416, "
            "172769.92245898946 174381.99321113512, "
            "172769.86473163788 174381.87794843127, "
            "172766.27740298968 174374.71225113448, "
            "172766.12751504182 174374.37625125528, "
            "172765.45154720507 174372.86111561494, "
            "172764.5623949914 174370.86834713045, "
            "172758.44661898166 174358.71346712485, "
            "172758.08089647835 174357.9866221479, "
            "172758.0812897689 174357.9865175769, "
            "172757.8519399999 174357.5307988898, "
            "172754.4110373197 174349.3873883099, "
            "172754.41083817216 174349.3874620819, "
            "172754.04609390008 174348.52429801252, "
            "172753.7164504677 174347.74419976756, "
            "172753.71289365587 174347.7351269625, "
            "172752.91599497944 174345.84914711493, "
            "172752.96828298277 174345.83532311398, "
            "172752.74697099614 174345.2712271516, "
            "172750.88521097507 174340.5253711095, "
            "172749.90261897308 174337.94073110458, "
            "172742.68309897187 174319.57548309487, "
            "172729.2444429621 174323.76869909838, "
            "172729.1040909663 174323.3482191004, "
            "172719.76546695834 174325.91705109927, "
            "172721.48245895657 174332.9833551049, "
            "172723.08294328308 174339.57013976108, "
            "172723.03791828503 174339.58436050604, "
            "172723.15793999998 174340.07079887998, "
            "172719.07994 174341.35879888994, "
            "172719.0331842302 174340.8492201192, "
            "172718.5874979483 174340.98998616525, "
            "172718.5534989536 174340.6227151118, "
            "172714.9709069505 174341.62623511252, "
            "172702.72073094547 174345.05746711424, "
            "172703.20898694542 174346.73209111392, "
            "172703.9096589461 174349.13503511623, "
            "172695.26953093708 174351.39500311756, "
            "172694.93771905327 174349.74538306356, "
            "172692.57990415473 174350.34580801197, "
            "172692.57334559556 174350.34747709305, "
            "172689.68390132912 174351.0828087242, "
            "172689.6768192437 174351.08460978328, "
            "172686.95894150986 174351.77579850602, "
            "172684.89594078047 174352.3007986814, "
            "172684.8828689878 174352.30412604674, "
            "172683.3009262921 174352.70680236846, "
            "172681.18281584515 174353.24583040207, "
            "172679.3319479569 174353.71579686215, "
            "172677.40094000465 174354.20779888882, "
            "172677.27266865686 174353.73419735025, "
            "172676.77394073328 174351.89280155062, "
            "172676.06193873903 174349.26679423897, "
            "172675.7409324217 174348.08277088706, "
            "172675.25994054292 174346.30780088357, "
            "172675.2596599193 174346.30676614863, "
            "172674.46692653303 174343.38374918967, "
            "172673.58194064876 174340.11780124725, "
            "172672.77094000002 174337.12779888004, "
            "172670.9499049531 174337.60880813404, "
            "172670.52563620973 174337.72080595847, "
            "172669.09919766168 174338.09735505903, "
            "172669.08994002102 174338.09979887708, "
            "172668.25594001057 174338.3197988899, "
            "172663.54094 174339.43779888, "
            "172663.9509396747 174340.9917976469, "
            "172663.95246609734 174340.9975798821, "
            "172664.37093995474 174342.5827987186, "
            "172664.9449393093 174344.75679626403, "
            "172665.47293987044 174346.75879839866, "
            "172665.473080069 174346.7593299183, "
            "172666.08593904617 174349.08279523588, "
            "172666.0860074876 174349.08305431984, "
            "172666.77093856825 174351.67579347026, "
            "172667.44093999997 174354.21779888, "
            "172665.21794001 174354.76179888, "
            "172665.0101183685 174354.8126524625, "
            "172663.37894000002 174355.21179888002, "
            "172663.37873282918 174355.21184957805, "
            "172661.5809427116 174355.65179822646, "
            "172659.15894248072 174356.2437982761, "
            "172656.24094000997 174356.95779889004, "
            "172655.8289405051 174354.98780124754, "
            "172655.30694000996 174352.49479888997, "
            "172654.75393999997 174349.85379887992, "
            "172653.44093999994 174347.26779887994, "
            "172650.79094000012 174346.37779887998, "
            "172649.39294039877 174346.74579877505, "
            "172649.3911846923 174346.7462610297, "
            "172648.1699417751 174347.06779842527, "
            "172643.14494001 174348.38979889, "
            "172642.93389291374 174348.44532466854, "
            "172640.56794000996 174349.06779889, "
            "172640.41789637046 174349.10727144754, "
            "172638.06294 174349.72679888003, "
            "172635.8089427633 174350.319798163, "
            "172634.01694338908 174350.79179799, "
            "172631.56094000998 174351.43779888997, "
            "172631.68094001 174351.69779888, "
            "172630.46894738195 174352.0517967368, "
            "172630.4687520214 174352.05185395735, "
            "172629.2809437475 174352.39979778518, "
            "172627.68094000997 174352.86779889, "
            "172628.10093847304 174354.1197943085, "
            "172628.10107294662 174354.1201945294, "
            "172628.6879379874 174355.86679290008, "
            "172628.68799114702 174355.86695143604, "
            "172629.43093933648 174358.08279688127, "
            "172629.43133035954 174358.0839622848, "
            "172630.24693959064 174360.5147976402, "
            "172630.24792235918 174360.51772822303, "
            "172630.85693939638 174362.3337970801, "
            "172631.76094 174365.02779888996, "
            "172632.43094001003 174364.86779888996, "
            "172632.93494001002 174366.67479888993, "
            "172630.87694000924 174367.2867988902, "
            "172629.35094510994 174367.69579751312, "
            "172629.35049890392 174367.69591735688, "
            "172627.54894514213 174368.17979751158, "
            "172627.52128803954 174368.18721035263, "
            "172625.4409402792 174368.7447988152, "
            "172625.43971959242 174368.74512604062, "
            "172623.82194391786 174369.17879783243, "
            "172621.82194405483 174369.715797794, "
            "172621.82183787943 174369.71582625585, "
            "172620.13194178292 174370.16879840213, "
            "172618.52894290345 174370.59879811114, "
            "172616.85694000009 174371.04679887995, "
            "172613.67694 174372.43679888, "
            "172612.2709414281 174372.87179843814, "
            "172610.70894325845 174373.35479788246, "
            "172608.85694 174373.92679889, "
            "172608.25794049533 174371.89080052968, "
            "172607.82694000003 174370.42679889002, "
            "172607.51030628625 174370.515852122, "
            "172607.38694001004 174370.06679887997, "
            "172607.01194001 174368.70179888996, "
            "172605.61394000004 174369.12679888998, "
            "172604.29194001 174364.49979887996, "
            "172605.79494001003 174364.27579888995, "
            "172604.95794001003 174361.23079889003, "
            "172604.15693999996 174358.31679887997, "
            "172601.3829428521 174359.08279810517, "
            "172600.24729543962 174359.3960325686, "
            "172597.84457264078 174350.6279695617, "
            "172597.51694001004 174350.71679888997, "
            "172593.94294000993 174351.68579889, "
            "172594.4599387648 174353.5957943269, "
            "172594.89194001 174355.18879888, "
            "172594.43694 174355.28679888998, "
            "172595.10393895835 174357.58879525043, "
            "172595.61693890326 174359.35679511022, "
            "172596.36993943545 174361.95579694142, "
            "172596.92693999998 174363.87679887997, "
            "172594.25694 174364.45679887995, "
            "172594.21693999998 174364.31679888006, "
            "172593.00494592657 174364.6537972349, "
            "172593.00452690053 174364.65391402238, "
            "172592.00394302807 174364.932798036, "
            "172590.26894162453 174365.41579843775, "
            "172588.36994388918 174365.94479780665, "
            "172588.36984125132 174365.94482635465, "
            "172586.29894001002 174366.52079888002, "
            "172585.7109407086 174364.2888015419, "
            "172585.71082483808 174364.2883622034, "
            "172585.01994076036 174361.66880173524, "
            "172584.8667329185 174361.0872324162, "
            "172584.37794 174359.23179888996, "
            "172583.4569404406 174355.73580051467, "
            "172582.56193999999 174352.34079887997, "
            "172581.81194 174349.49579887997, "
            "172578.96056568567 174350.36739802494, "
            "172585.1382444169 174374.19050227254, "
            "172585.0614705477 174374.21335843968, "
            "172585.18994 174374.69679888996, "
            "172581.69994000997 174375.73579888, "
            "172581.62350512363 174375.3929519558, "
            "172581.93994000004 174374.65479888, "
            "172582.48094 174373.39279888003, "
            "172580.61794 174366.54279888, "
            "172576.77667659082 174367.3948403584, "
            "172578.3008907684 174373.35775476237, "
            "172578.52405885607 174374.23071513322, "
            "172580.47195049844 174381.85118837637, "
            "172580.4625612569 174381.85333750857, "
            "172580.58694000004 174382.33779888, "
            "172578.45494 174382.82579888, "
            "172576.95294001 174376.09679888003, "
            "172576.23194 174376.15679888002, "
            "172575.20993999997 174372.55179889, "
            "172573.66458694366 174372.8308626458, "
            "172574.0934668556 174374.3819471337, "
            "172574.33365876754 174375.25074680167, "
            "172574.7994377378 174376.93505831185, "
            "172574.46694027368 174377.10679874866, "
            "172573.55473542705 174377.38586125555, "
            "172571.95794220705 174377.87279822002, "
            "172569.12694000997 174378.73679888004, "
            "172570.29693999997 174382.59679888, "
            "172569.06894000657 174382.95779888806, "
            "172568.98899089158 174382.9810527852, "
            "172567.62494267538 174383.37779810186, "
            "172566.1759413303 174383.7987985035, "
            "172564.9709467131 174384.14879693012, "
            "172563.53494001646 174384.5647988781, "
            "172562.23594001002 174384.94279888997, "
            "172561.03905731053 174385.28960586703, "
            "172554.56188284606 174386.74853914225, "
            "172555.21404284242 174388.99244314435, "
            "172557.3838523062 174396.45835165278)),"
            "((172739.38594000007 174460.04779889, "
            "172739.39373637483 174460.04610350684, "
            "172739.392673916 174460.04121769255, "
            "172739.3870486459 174460.03837656736, "
            "172739.38261013498 174460.0403655549, "
            "172739.3807950899 174460.03631378766, "
            "172739.37623201194 174460.03835788142, "
            "172739.37262919155 174460.04530889943, "
            "172739.37358944913 174460.05021582366, "
            "172739.3858038434 174460.04782553512, "
            "172739.3859399994 174460.04779889015, "
            "172739.38594000007 174460.04779889)))"
        )
        result = safe_symmetric_difference(
            polygon_a, polygon_b
        )  # GEOS exception is caught
        self.assertTrue(result.is_valid)

    def test_get_partitions(self):
        # Test partition function
        delta = 2.0
        sample_geom = Polygon([(0, 0), (0, 10), (10, 10), (10, 0)])
        filtered_partitions = get_partitions(sample_geom, delta)

        # Check if the result is a list of Polygon objects
        assert isinstance(filtered_partitions, list)
        for partition in filtered_partitions:
            # assert partition is a Polygon object
            assert isinstance(partition, Polygon)


class TestGridBounds(unittest.TestCase):
    def test_grid_bounds_empty_polygon(self):
        """Tests grid_bounds with an empty polygon."""
        polygon = Polygon()
        result = _grid_bounds(polygon, 1.0)
        self.assertEqual(result, polygon)

    def test_grid_bounds_small_grid(self):
        """Tests grid_bounds with a small area not requiring grid division."""
        polygon = Polygon([(0, 0), (1, 0), (1, 1), (0, 1)])
        result = _grid_bounds(polygon, 2.0)
        self.assertEqual(len(result), 1)

    def test_grid_bounds_grid_division(self):
        """Tests grid_bounds with an area requiring grid"""
        polygon = Polygon([(0, 0), (0, 5), (5, 5), (5, 0), (0, 0)])
        result = _grid_bounds(polygon, 1.0)
        self.assertEqual(len(result), 25)
